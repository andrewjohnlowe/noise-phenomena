---
title: "From noise to knowledge: how randomness generates novel phenomena and information"
author:
  - name: "Carl Boettiger"
    affiliation: a, 1
address:
  - code: a
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"
  
layout: preprint
abstract: |
  In this paper, I provide a brief synthesis of ecological research in stochastic phenomena. Noise, as the term itself suggests, is most often seen a nuisance to ecological insight, a inconvenient reality that must be acknowledged, a haystack that must be stripped away to reveal the processes of interest underneath. Yet despite this well-earned reputation, noise is often interesting in its own right: noise can induce novel phenomena that could not be understood from some underlying determinstic model alone.  Nor is all noise the same, and close examination of differences in in frequency, color or magnitude can reveal insights that would otherwise be inaccessible.  While an exhaustive review is beyond the scope of this piece, I endeavor to highlight some of the most interesting examples of both noise-induced phenomena and noise-derived information, and point the way towards yet uncharted territory.
  


keywords:
  - stochasticity
  - demographic noise
  - environmental noise
  - colored noise
  - quasi-cycles

lineno: true

bibliography: refs.bib
output: rticles::elsevier_article
---

```{r libraries, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, dev="CairoPDF", fig.width=7, fig.height=3.5)
library(ggthemes)
library(tidyverse)
library(cowplot)
library(hrbrthemes)
extrafont::loadfonts()
#extrafont::font_import()                    # One-time use to set up fonts
#hrbrthemes::import_roboto_condensed()       # One-time use to set up fonts
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
#ggplot2::theme_set(theme_bw()) # simpler theme if you do not have these fonts
colours <- ptol_pal()(2)
```


<!--

We hope that these papers will combine a mix of synthetic reviews of the current state of an area, as well as insights into how the field has developed during the last twenty years, discussion of current important questions, and developments and insights that would significantly advance the field. Although certainly not necessary, if there are any past Ecology Letters papers that have had a profound impact on the development of an area – be it beneficial or not – a brief discussion of that impact would be appropriate. We also hope that articles will be written in a thoughtful style, but also provocative if appropriate.


- Key questions
- Key advances

Moving beyond "everything is important" [@Bjornstad2001; @Kingsland1985]

@Bjornstad2001 future: more MCMC methods. More mechanistic models.  dealing with unobserved dynamics

Noise -> informer


Shift from noise as nuiance to noise as opportunity
Stochastic phenomena outside of theory -- early warning signals

Need for greater tanslation

Discuss out of scope:  
 - behavior
 - evolutionary dynamics examples?? 


Bialek's rules
1. Noise isn't negligible: photon counting, chemotaxis, 
2. No fine tuning: developmental patterning? ion channels/ stochastic switches? 
3. Efficient representation: entropy, information flow

-->


# Introduction: Noise the nuisance

Stochasticity is most often thought of as something which obscures patterns we are trying to infer.  This is a simple consequence of modeling: as discussed above, variables of interest to the processes in question are modeled explicitly (e.g. change in population density as it depends on the current density), everything else is just noise.  Most statistical inference in ecology is built solely to deal with this problem: pulling back the veil of noise to reveal processes of interest.  Unfortunately, given the high levels of variation and relatively limited data typical in ecological analyses, this can be a significant challenge, and even as statistical and computational advances provide more powerful and accessible inference tools, the task only gets harder.  For instance, few ecological concepts are more central than the notion of density dependence: that competition in some form or other should limit a species ability to grow without bound.  Yet establishing statistical evidence for density dependence is remarkably difficult, as illustrated by a landmark study of @Knape2011.  Using time series from the Global Population Dynamics Database (GPDD) @Knape2011 show that once one accounts for the potential for measurement error in addition to environmental stochasticity -- an unavoidable source of noise in most ecological data -- it becomes difficult to find evidence for even the simplest models of density dependence in the majority of available time series.  Faced with such uncertainty, it is tempting to throw up our hands and wait until some prophesied deluge of streaming micro-sensors stapled to every organism provide enough signal to beat back the noise. Fortunately, this has not been the path taken.  


<!-- okay, claiming this for the last 2 decades might be overly provocative?-->
Over the past twenty years, ecological theory, modelling, and methods have increasingly elucidated the role of noise not only to *obscure* patterns but to *create* them.  This period marked a transition away from the intense focus on simple models which exhibited deterministic chaos that had enchanted much of theoretical ecology in the previous two decades [@Bjornstad2001] in favor of more complex and stochastic models.  Of particular interest has been those conceptual advances that have bridged the divide from theoretical to empirical interest -- not merely the introduction of "real data" in a theoretical paper, but rather the concepts that take on a life of their own in the larger research community.  Consequently, this paper seeks to be a bridge between two audiences: theoretical researchers already expert in noisy phenomena but in interested in reaching wider empirical application, and also primarily empirical researchers seeking an entrance into noisy phenomena.  


<!-- Regarding simulation examples -->
In this spirit, each of the examples illustrated here is coupled with concise and efficient R code in the appendix to both reproduce and further explore the simulations.  While examples of noisy phenomena in natural systems are also crucial, matching the pattern does not necessarily mean we have also matched the process behind the data.  The examples cited from the literature here offer some of the best empirical evidence of these phenomena, but I encourage readers to also experiment with the example code provided.  Simulations permit poking and prodding of empirical investigation quickly and with little mathematical formalism in the way.  In the code provided, most stochastic models are expressed in the BUGS language, which may be more familiar to empirical readers than corresponding mathematical formulas. This also permits both efficient simulation and potential estimation of parameters given sample data using the R package, NIMBLE [@DeValpine2017]. A copy of this appendix is maintained at <https://github.com/cboettig/noise-phenomena>, and bug reports, suggestions or help requests are welcome through the issue tracker.  A second appendix provides more mathematical details for interested readers.  With these in place, we are ready to begin our tour through three major areas of noisy phenomena: Origins of noise, emergent phenomena, and noise-driven inference.

<!-- MAP -->
Our first stop will be into research into the origins of noise.  This will not only let us set up definitions for terms and concepts we will encounter throughout, but also introduce some of the fundamental mathematical and computational tooling needed in our tour of noisy phenomena.  From origins of noise, we will then explore some of the phenomena that noise can create.  These examples are central to the conceptual transition away from viewing noise only as a nuisance that obscures patterns and realize the rich set of patterns and phenomena that can emerge.  Our tour will be by no means exhaustive, but as with chaos before it, theoretical allure does not always reflect ecological relevance.  Having looked at some of the phenomena that can be created by noise, our third stop will try to run this in reverse: using noise to infer underlying phenomena.  Examples here are rarer but potentially the most rewarding, bridging the gap from theoretical construct to empirical investigation.  The most compelling examples have come from ways in which noisy phenomena are used to infer stability and forecast changes in resilience of populations or ecosystems. Though not without weaknesses or missteps, the resulting dialog between theoretical and empirical aspects have made this particularly a rich area of research.  We end our tour by considering what features best enable the translation and ecological relevance of noisy phenomena.  


# Origins of noise


What is noise? Where does it come from?  It is important to bear in mind that whenever stochasticity is introduced into a model, it is only as a simplification or summary of the effects of a large number of other processes, often occurring at different scales.  Simply put, *noise is all that we leave out of our model*.  Frequently, this additional noise is tacked on to the end of a model, as if as an afterthought, 

$$X_{t+1} = f(X_t) + \xi_t$$
with the assertion that $\xi$ is some normally distributed noise term reflecting the combined effects of any large array of possible factors that also influence the value of our state, $X$.  While not always wrong, this hand-waving over-simplification is increasingly replaced with a more ecologically and mechanistically grounded description for the origins of noise.  With the exception of quantum mechanics (and there only at scales that have no relevance to ecology), stochasticity is not an inherent property of nature but rather an emergent property of many events occurring at a different scale.  Coins and dice obey the physical laws of motion; only variation in how they are tossed (i.e. something complex we do not usually model) creates randomness.  The term "noise" itself reflects this emergent rather than fundamental origin: the combination of hundreds of voices and sounds each individually distinct blends together into a background of noise. Statistical mechanics tells us that temperature is a measure of the average speed of individual molecules in a gas -- any given molecule will experience a range of possible speeds but by itself has no notion of temperature.  Likewise, stochasticity enters our ecological models because our quantities of interest, such as the density of a population, is but an average over a lower-level, discrete process of individual births and deaths. Stochasticity that emerges directly from discrete individual events that underlie the process described by our model are considered *intrinsic stochasticity*, commonly referred to as *demographic stochasticity* in ecological literature, as it usually arises in the context scaling from individual demographic events to population level descriptions. An important aspect of this demographic stochasicity is that it scales with the square root of the "system size," so that for very large populations the resulting fluctuations are relatively small. On the other hand, *extrinsic stochasticity*, usually referred to as *environmental stochasticity* in the ecological literature, arises in processes that are not described by our model, but merely impact the value of some parameter of our model; for instance, fluctuations in temperature may drive variation in a death rate, or fluctuations in rainfall drive variation in carrying capacity.  

<!--
Early ecological models were almost always formulated at the level of the population, described in terms of differential or difference equations reflecting the available tools of the time.  The advent of fast and inexpensive computing power 
--> 

@Black2010 provides an excellent review of the importance of intrinsic stochasticity and the evolution

Consider Levins' patch model, where $n$ individuals compete for a finite number of suitable habitats $N$.  Individuals die a constant rate $e$, and produce offspring at a constant rate $c$ who then have a probability of colonizing an open patch that is simply proportional to the fraction of available patches, $1 - n/N$.  

Approximations of the so-called master equation, van Kampen system size approximation [@vanKampen2007] described in @Black2010, (rooted in the theorems of [@Kurtz1970; @Kurtz1971]), 


<!-- Intrinsic vs extrinisic: a matter of perspective.  demographic noise in one variable is environmental noise in another.  environmental variation usually implies the environmental variable is simply independent of the -->


Our variables of interest themselves

The behavior of our variables depends on some quantity which itself is a

<!-- Stochasticity is not inherent -->

<!-- 
$$\textrm{d} X_t = \mu(X_t) \textrm{d}t + \sigma(X_t) \textrm{d}B_t$$

An SDE. Note the separation of the differential elements, which reveal that this is actually shorthand for an integral equation:

$$X_{t+s} - X{t}  = \int_t^{t+s} \mu(X_{\tau}, \tau) \textrm{d}\tau + int_t^{t+s} \sigma(X_{\tau}, \tau) \textrm{d}B\tau$$

The first integral is the ordinary Lebesgue integral, while the second is an It\^o integral, which integrates over the stochastic process $B_t$ (Brownian motion, also termed a Weiner process). The It\^o calculus follows different rules from the classic calculus, largely due to the fact that an It\^o integral has non-zero quadratic variation. (Crudely put, $\textrm{d}x^2 \sim 0$, but $\textrm{d}B^2 ~ dx$).

-->


While ecologists will sometimes assert that stochasticity is inherent: birth and death are inherently stochastic events; or the environment is inherently stochastic, these are only assertions at a particular scale.  Obviously events such as births and deaths are themselves the results of mechanistic processes, just as fluctuations in rainfall and temperature are the result of deterministic laws of physics and not fundamentally random forces.  In all of science, only quantum mechanics claims a fundamentally probabilistic view of events, and then at such scales that have no relevance to ecology.  
<!-- Our state variables don't "exist" except as averages of a lower level process -->




**Demographic stochasticity**.  Demographic stochasticity refers to fluctuations in population sizes or densities that arise from the fundamentally discrete nature of individual birth and death events.  Demographic stochasticity is a particularly instructive case for illustrating a mechanism for how noise arises as an aggregate description from a fundamentally lower-level mechanistic process.  We summarize the myriad lower-level processes that mechanistically lead to the event of a 'birth' in the population as a probability: in a population of $N$ identical individuals at time $t$, a birth occurs with probability $b_t(N_t)$ (_i.e._ a rate that can depend on both the population size $N$) and increases the population size, $N$ to $N+1$, and deaths occur with probability $d_t(N_t)$, decreasing the population size, $N$ to $N-1$.  Assuming each of these events are independent, this is a Poisson process.  

<!-- Master equation solution of birth-death model, from appendix--> 

<!-- Gillespie algorithm; Population level (SDE) vs agent-based vs individual. Show figure with small and large N  -->

<!-- Figure 1: Gillespie simulations -->
```{r gillespie, warning=FALSE, fig.width=7, fig.cap="Population dynamics from a Gillespie simulation of the Levins model with large (N=1000, panel A) and small (N=100, panel B) number of sites (blue) show relatively weaker effects of demographic noise in the bigger system. Models are otherwise identical, with e = 0.2 and c = 1 (code in appendix A). Theoretical predictions for mean and plus/minus one standard deviation shown in horizontal re dashed lines."}
read_csv("appendixA/gillespie.csv", col_types = "cdiddd")  %>% 
  mutate(system_size = recode(system_size, large = "A. 1000 total sites", small= "B. 100 total sites")) %>%
  ggplot(aes(x = time)) + 
  geom_hline(aes(yintercept = mean), lty=2, col=colours[[2]]) + 
  geom_hline(aes(yintercept = minus_sd), lty=2, col=colours[[2]]) + 
  geom_hline(aes(yintercept = plus_sd), lty=2, col=colours[[2]]) + 
  geom_line(aes(y = n), col=colours[[1]]) +
  facet_wrap(~system_size, scales = "free_y") 
```




[@Black2012]

**Environmental stochasticity**.  Whereas demographic noise reflects processes at a lower scale (the individual, rather than the population), environmental stochasticity reflects processes operating at the same scale that we are not explicitly modelling.  


Given ecologists natural inclination towards modeling the biological rather than environmental aspects of a system, it will be no surprise that mechanistic descriptions of environmental stochasticity have remained far more fuzzy.  One step in this direction has been recognition that whatever the mechanisms, this variation is unlikely to result in purely white noise, as commonly postulated for mathematical convenience, but rather some degree of correlation, termed red noise, or possibly anti-correlation such as from seasonal or other oscillatory patterns, so called blue noise.

[@Roughgarden; @Ellner] 


<!-- Demographic noise scaling away with population size, but not so for environmental noise -->

[@Bjornstad2001] _Science_ Review of noisy fluctuations 

[@Melbourne2008] Importance of demographic stochasticity and its interaction with environmental stochasticity in driving extinction risk. 
[@Bonsall2004] Markov chain environmental and demographic noise predator-prey metapopulation model.  

Colored noise:
- [@Ripa1999]
- [@Marshall2015]


<!-- Identify as beyond the scope of this paper -->
<!-- non-temporal stochasticity --> 

Several additional sources of stochasticity or variation more generally fall outside these categories demographic and environmental noise.  While a detailed treatment is beyond the scope of this paper, I enumerate these sources to disambiguate such phenomena from the intrinsic and extrinsic noise sources that comprise the focus here. 

**Other forms of stochasticity**.  Stochasticity frequently enters our models in other ways as well.  For instance, most population-level models treat all individuals within the population, or at least within a particular age or stage class, as identical.  *Individual heterogeneity* in relevant traits (growth rates, dispersal ability) can be represented probabilistically as a distribution rather than a fixed value, making it function as another form of random variation in a model.  *Spatial heterogeneity* can likewise be reflected in stochastic parameters of a spatially implicit model, or as spatially varying environmental stochasticity in a spatially explicit model.  As with other forms of noise [@Melbourne2008; @Bonsall2004], interaction between individual or spatial variation and other sources of noise can drive patterns including the potential for persistence, coexistence, and dispersal of species [@Schreiber2010; @Hart2016; @Schreiber2017].  

**Observational error**: Observational error acts much like another form of stochasticity, arising from
sampling effects or limitations of instruments, etc. Yet unlike the sources described above, this 
uncertainty does not impact the actual state of our system, and thus does not give rise to any
additional phenomena or information about that process, though it can obscure it [@Knape2011; @deValpine2002].

Other forms of uncertainty common in models are not stochastic phenomena.  This includes any form of 
**reducible uncertainty**: In constructing and estimating mathematical models of ecological processes, 
we encounter uncertainty over our parameter estimates and possible choice of models [@Ellison2004].  In some ways, this
uncertainty can act like the stochasticity described above: for instance, both introduce variation into
any forecast of future outcomes. Yet unlike stochasticity, this uncertainty is reducible: with additional
observations, we can narrow the uncertainty over parameters or candidate models, while stochasticity remains an
inherent source of variation. We will this not consider model and parameter uncertainty, as they are not 
sources of noise.  

**Chaos**: Deterministic chaos [@Desharnais2001] is another mechanism of introducing significant variation into a simple model. Chaos can a look a lot like noise: indeed, it can be observationally indistinguishable from a stochastic process [@Werndl2009].  Despite substantial interest in previous decades and the relative ease of encountering chaos in simple ecological models (particularly in differences equations), and convincing reconstructions of chaotic dynamics in laboratory manipulations [@Costantino1997] the prevalence of chaotic dynamics as a driving factor in most ecological systems remains unclear. After all, the great variation of natural populations is hardly surprising: the undeniable influences of variation created by all those things left out of our models, all that individual detail from intrinsic, lower level processes and external environmental processes that becomes aggregated in our simple models all but begs for a stochastic description.  


Much active research continues to explore the consequences of introducing these more explicitly motivated and interacting sources of noise. With some grounding in the origins of different types of noise in place, we are ready to move to our second stop to see how this noise can drive the creation of novel phenomena on a macroscopic level.  


# Noise the creator: Noise can induce novel phenomena

Stochasticity can give rise to a wide array of interesting phenomena that are often at odds with our intuition. Such behavior often arises through an interaction between stochastic and non-linear elements of a system, both hallmark traits of ecological processes.  In this section, I highlight several examples that have shown up frequently in the literature and prove sufficiently tractable to provide a simple intuition for the mechanisms involved. 

## Quasi-cycles 

Understanding the origin of sustained oscillations has long been a central question in ecology [@Hastings1996; @Bjornstad2001].  The simple Lotka Volterra model produces only neutrally stable centers, while the more realistic model that introduces carrying capacity for prey as they compete for resources results in a model that produces only damped oscillations, eventually settling into a stable state (Figure 1A).  However, the introduction of relatively small noise into the system can be sufficient to excite the system into sustained oscillations (Figure 1B).  In the example shown here, a simple predator-prey system is driven by environmental white noise $\xi_t$, with prey following the equation:

$$x_{t+1} = x_t + x_t r \left(1 - \frac{x_t}{K}\right) - b x_t  y_t + \xi_{x,t}$$
where $x_t$ is the prey density at time $t$, $r$ the growth rate, $K$ the carrying capacity, $b$ an encounter rate with the predator $y$, who obeys the equation:

$$y_{t+1} = y_t + c  x_t  y_t - d  y_t+ \xi_{y,t} $$
with $c$ the conversion ratio and $d$ the predator mortality rate.  Here we have assumed for the prey, $\xi_x \sim \mathcal{N(0, \sigma_x)}$, and similarly for the predator driven by $\xi_y$. Figure 1A shows examples for noise $\sigma_x = \sigma_y = 10^{-5}$, while Figure 1B shows $\sigma_x = \sigma_y = 0.01$.  

<!-- Figure 2: Quasi-cycles -->
```{r quasicycles, fig.width=7, fig.cap="Panel A: under negligible environmental noise, the introduction of a carrying capacity damps Lotka-Volterra oscillations which eventually settle to a stable state.  Panel B: small noise induces quasi-cycles in the same model: sustained long-term oscillations predominately around the natural frequency of the original damped oscillations. Parameters for models shown are r = .1, K = 5,  b = .1, c = .1, d = .1, N = 800; code in Appendix A."}
read_csv("appendixA/quasicycles.csv") %>%
  gather(species, population, -t, -sigma) %>%
  mutate(sigma = as.factor(sigma)) %>%
  mutate(sigma = recode(sigma, "1e-05" = "A.", "0.01" = "B.")) %>%
  rename(time = t) %>%
  ggplot(aes(time, population, col = species)) + geom_line() + 
  facet_wrap(~ sigma, ncol=2) + scale_color_ptol() #+ 
#  labs(x="Time", 
#       y="Population density",
#       title="Noise induces quasi-cycles",
#       caption="Left panel: neglible  noise results only in damped oscillations.\nRight panel: small noise creates sustained oscillations.")
```


Oscillations arise through the process of stochastic resonance.  The damped oscillations seen in Figure 1a are analgous to a child sitting still on a swing: friction slowly damps the magnitude of each successive oscillation, while the period of pendulum remains unchanged.  Driving the pendulum through perturbations timed to match that natural period can quickly create sustained oscillations with large magnitudes, but such perfect timing is not required.  In the model above, white noise effectively drives the pendulum at all frequencies, though at very low magnitude, since the noise is small relative to the scale of the dynamics.  However, frequencies that most closely match the natural period of the damped oscillator are amplified, resonating with the natural oscillations.  This process is sufficient to permit even small noise to drive sustained oscillations in the model indefinitely.  

The power spectrum (the squared norm of the Fourier transform, a measure of what frequencies are present; see, e.g. @Black2012) provides a convenient way to visualize the effects of these oscillations.  The power spectrum  for a deterministic limit cycle would create a perfect sinusoidal oscillation and a resulting power spectrum of a delta spike at that single frequency.  The power spectrum for the quasi-cycle instead shows a distribution of frequencies, centered at the the resonant frequency of the damped oscillator.  

Early work by @Blarer1999 identified quasi-cycles as a possible explanation for oscillations and periodic outbreaks in pest ecosystems.  @Bjornstad2004 analyzes the potential for such stochastic effects to drive cyclic behavior in population abundances of Atlantic bluefin tuna and Atlantic Cod, while @Black2010 illustrates the use of power-spectrum approaches to examine the behavior of quasi-cycles in common disease outbreak models, focusing on a case where noise arises explicitly from demographic stochasticity, rather than generic environmental noise as in the model above and elsewhere.  @Pineda-Krch2007 compares patterns from these stochastically generated cycles to truly stable limit cycles they resemble.  

Stochastic resonance highlights one way in which even small noise can play an important role in driving large scale patterns where we had previously only sought deterministic explanations. This example also illustrates the interplay between nonlinear dynamics and stochasticity that is the hallmark of stochastically driven phenomena.  A stable node with linear dynamics, such as an Ornstein-Uhlenbeck process, has no resonant frequency, and could not produce sustained oscillations (unless the environmental driver itself had a periodic pattern).  

<!-- variable noise -->

<!--autocorrelated or red noise can also drive stochastic resonance -->



## Stochastic switching

We turn from stochastic resonance to oscillations of a very different sort, which do not resemble any deterministic process, as seen in Figure 3.

<!--Figure 3: Noisy switch -->
```{r noisy_switch, fig.width=7, fig.cap="Stochastic switiching in May's model of alternative stable state dynamics.  r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 10000"}

panel1 <- read_csv("appendixA/noisy_switch.csv")  %>%
  ggplot(aes(t,x)) + 
  geom_line(lwd=.1, col=colours[[1]]) +
  labs(subtitle = bquote(bold(A.)))

p <- list(r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 1e4)
f <- function(x) x * p$r * (1 - x / p$K)
g <- function(x) p$a * x ^ p$Q / (x^p$Q + p$H^p$Q)
x <- seq(0,2, length.out = 100)

panel2 <- data.frame(x, f = f(x), g = g(x)) %>%
  ggplot(aes(x, y)) + 
  geom_line(aes(y = f), col=colours[1], lwd=1) +
  geom_line(aes(y = g), col=colours[2], lwd=1) + 
  labs(x = bquote(X[t]), y = bquote(X[t+1]), subtitle= bquote(bold(B.)))

library(gtable)
library(grid) # low-level grid functions are required
g1 <- ggplotGrob(panel1)
g2 <- ggplotGrob(panel2)
g <- cbind(g1, g2, size="first") # stack the two plots
#g$widths <- unit.pmax(g1$widths, g2$widths) # use the largest widths
grid.newpage()
grid.draw(g)
```


This pattern is characterized by long stretches during which fluctuations in the state variable remain concentrated around a high average value followed by sudden, rapid transistions into fluctuations concentrated around a lower value.  This behavior arises through the interaction of stochasticity and alternative stable state dynamics.  The simulation shown in Figure 3 is based on an herbivore consumption model first proposed by @May1977 as one of the early examples of the potential for alternative stable state dynamics, to which I have simply introduced an additional environmental noise term:

$$X_{t+1} = X_t + \underbrace{X_t r \left(1 -\frac{X_t}{K} \right)}_{\textrm{Vegitation growth}}  - \underbrace{\frac{a X_t ^ Q}{X_t^ Q + H ^ Q}}_{\textrm{Vegitation consumption}} + \xi_t,$$
where $\xi_t$ is normally distributed environmental variation with mean zero and standard deviation $\sigma$.  

Stochastic fluctuations can also drive spontaneous shifts between alternative stable states.  

[@Boettiger2012]

[@Drake2013]

- transition probabilities, waiting times

**Inflation**

Stochasticity can 

<!-- two concurrent flat lines makes for a poor figure -->

**Persistence and coexistence**

One of the most fundamental aspects of stochasticity are the implications for long-term persistence of any given population and the stable coexistence of interacting species.  

**Bet hedging**



**Further examples**


@Read2007 <!-- Stochasticity generates an evolutionary instability for infectious disease -->


[@Schreiber2008] decreasing variance before crash

- Spatial pattern formation 

Turning patterns found in plankton-herbivore dynamics [@Levin1976]

- Population persistence (bet-hedging)


Individual heterogeneity: spatial spread? persistence? 

- Species coexistence  ([@Hart2016])


# Noise the informer: Noise can provide novel information

One of the most interesting aspects of noise is as a source of additional information.  Noise can act like a miniature perturbation experiment, constantly perturbing a system away from an equilibrium to reveal it's behavior elsewhere in state space.  

- Measuring stability



**Early warning signals.**  The theory of early warning signals, or critical slowing down (CSD) [@Wissel1984; @Scheffer2009] is an instructive example 




<!-- @Holling1996 is responsible for the introduction of the unfortunate term "Engineering Resilience" to mean precisely the same thing as mathematicians and theoretical ecologists have refered to as 'stability' for decades.  Further confusion has been sown by the introduction of the energy-potential diagram into ecology, where the depth of the potential well is not a local property-->

<!-- Figure 4: Early warning signals -->
```{r tipping, fig.width=7, fig.height=7}
tipping <- read_csv("appendixA/tipping.csv") 

p1 <- tipping %>%
  select(-x) %>%
  rename("A. autocorrelation" = autocorrelation, "B. variance" = variance) %>%
  gather(series, value, -t, -tip_time) %>%
  ggplot(aes(t, value)) + geom_line(col=colours[[1]]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[[2]], lty=2) +
  facet_wrap(~series, ncol = 2, scales="free_y")  +
  theme_ipsum_rc() 
p2 <- tipping %>% 
  select(t, population = x, tip_time) %>%
  ggplot(aes(t, population)) + geom_line(col=colours[[1]]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[[2]], lty=2) + 
  #scale_y_log10()  + 
  theme_ipsum_rc() + 
  labs(subtitle = "C. Yeast population size", 
       caption = "Vertical red dashed line indicates tipping point location")

library(cowplot)
ggdraw() +
  draw_plot(p1, x = 0, y = .5, width = 1, height = 0.5) +
  draw_plot(p2, x = 0, y = 0, width = 1, height = 0.6)
```


Challenges remain in distinguishing these patterns from other causes [@Boettiger2013a] which will ultimately require more domain-specific information  [@Boettiger2013b]. 

<!-- FIXME unclear, rambling!-->
It is important to realize that such approaches can only ever measure local properties such as the return time in response to local perturbation (historically termed *stability*; which @Holling1996 landmark chapter unfortunately re-brands as "engineering resilience") and not global properties such as the size of the attractor basin / distance to the nearest tipping point (*ecological resilience*, or simply *resilience*).  This is illustrated rather vividly in @Dai2015, which illustrates how a system can lose resilience before losing stability, resulting in a scenario that provides less opportunity for early warning.




# Conclusions

# References