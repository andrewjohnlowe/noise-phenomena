---
title: "From noise to knowledge: how randomness generates novel phenomena and reveals information"
author:
  - name: "Carl Boettiger"
    affiliation: a
    email: "cboettig@berkeley.edu"

address:
  - code: a
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"

## Use trends style to quickly count refs
csl: trendsjournals.csl
#csl: ecology-letters.csl
bibliography: refs.bib
output: 
  rticles::elsevier_article:
    keep_tex: true
layout:  3p # review = doublespace, 3p = singlespace, 5p = two-column
preamble: |
  \newcommand{\ud}{\mathrm{d}}
  \usepackage[nomarkers]{endfloat}
  \journal{Ecology Letters}
  \linenumbers
  \usepackage{setspace}
  \doublespacing


abstract: |
  # Article Type: Review & Synthesis
  # Running title: Noise phenomena
  # Figures: 4
  # Tables: 0
  # Word count: 
  # Word count in abstract: 
  # Number of References: 
  # Archive statement:

  All data (simulated data and code) is made available on GitHub (<https://github.com/cboettig/noise-phenomena>), and if accepted, will be archived with provided DOI in an appropriate scientific data repositoriy.

  # Keywords: stochasticity, demographic noise, environmental noise, colored noise, quasi-cycles, tipping points

  \newpage 
    
  # Abstract
  
   Noise, as the term itself suggests, is most often seen a nuisance to ecological insight, a inconvenient reality that must be acknowledged, a haystack that must be stripped away to reveal the processes of interest underneath. Yet despite this well-earned reputation, noise is often interesting in its own right: noise can induce novel phenomena that could not be understood from some underlying determinstic model alone.  Nor is all noise the same, and close examination of differences in frequency, color or magnitude can reveal insights that would otherwise be inaccessible.  Yet with each aspect of stochasticity leading to some new or unexpected behavior, the time is right to move beyond the familiar refrain of "everything is important" [@Bjornstad2001].  Stochastic phenomena can suggest new ways of inferring process from pattern, and thus spark more dialog between theory and empirical perspectives that best advances the field as a whole. I highlight a few compelling examples, while observing that the study of stochastic phenomena are only beginning to make this translation into empirical inference.  There are rich opportunities at this interface in the years ahead.  
  


#keywords:
#  - stochasticity
#  - demographic noise
#  - environmental noise
#  - colored noise
#  - quasi-cycles
#  - tipping points

---

```{r libraries, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, dev="cairo_pdf", fig.width=7, fig.height=3.5, cache = FALSE)
library(tidyverse)
library(gridExtra)
library(ggthemes)
library(png)
colours <- ptol_pal()(2)

#https://stackoverflow.com/a/24241954/258662
fancy_scientific <- function(l) { 
     l <- format(l, scientific = TRUE)
     l <- gsub("^(.*)e", "'\\1'e", l)
     l <- gsub("e", "%*%10^", l)
     l <- gsub("^'1'%\\*%", "", l)
     l <- gsub("\\+", "", l)
     parse(text=l)
}
```

```{r suggested_libs, cache = FALSE}
library(hrbrthemes)
library(extrafont)

##extrafont::font_import(prompt=FALSE)    # One-time use to set up fonts, can be slow.
hrbrthemes::import_roboto_condensed()   # One-time use to set up fonts 
extrafont::loadfonts()
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
```



\newpage


# Introduction: Noise the nuisance

To the empirical ecologist, stochasticity, or more simply, "noise,"
is just that -- something which obscures patterns we are trying to infer [@Knape2011];
and an ever richer batteries of statistical methods are developed largely in an
attempt to strip away this undesirable randomness to reveal the patterns
beneath [@Coulson2001].  Over the past several decades, theoretical ecology has transitioned
from thinking of stochasticity in such terms; where noise is a nuisance
that obscures the "deterministic skeleton" of the underlying mechanisms,
to the recognition that stochasticity can itself be a mechanism for 
driving many interesting phenomena [@Coulson2004].  Yet this transition from "noise the nuisance"
to "noise the creator" of ecological phenomena has had, with a few notable exceptions,
relatively little impact in empirical thinking about stochasticity.  One of the
most provocative of those exceptions has turned the classical notion of noise
the nuisance on its head: recognizing that noise driven phenomena can become a tool
to reveal underlying processes: to become "noise the informer."  Here I argue that
this third shift in perspective offers an opportunity to better bridge the divide
between respective primarily theoretical and primarily empirical communities by 
seeing noise not as mathematical curiosity or statistical bugbear, but as a
source for new opportunities for inference. 

<!-- -->

The gap between specialists and non-specialists is particularly acute in the
ecological literature on stochastic processes.  This makes the potential benefit
for new synthesis all the greater, but also poses an obvious challenge in 
appealing to both audiences.  In recognition of this, I provide concise and
commented code for simulating each of the models presented in the supplement,
Appendix A, while more mathematical background and derivations are presented Appendix B.
Numerical simulations permit poking and prodding of empirically-minded
investigation unencumbered by either experimental design or mathematical formalism.
Most stochastic models are expressed in the BUGS language, which
may be more familiar to empirical readers than corresponding
mathematical formulas. This also permits both efficient simulation
and potential estimation of parameters given sample data using the
R package, NIMBLE [@deValpine2017]; allowing the deductive models
illustrated here to readily function as inductive models with
parameters inferred from time-series data. A copy of this appendix
is maintained at <https://github.com/cboettig/noise-phenomena>, and
bug reports, suggestions or help requests are welcome through the
issue tracker. 



To emphasize the underlying trend in the changing roles in which we
see and understand noisy processes, I will also restrict my focus 
to relatively simple models primarily from population ecology context.
Simplicity not only makes examples (in equations and in code) more
tractable but also allows us to focus on aspects that are germane to many
contexts rather than unique to particular complexitites [@Levins1966; @Bartlett1960].
Nevertheless, that complexity matters -- few themes have been better 
emphasized in the theoretical literature [@Bjornstad2001].  Both
the foundational literature and recent research continue to echo the
theme of understanding the impact different real world complexities
have in stochastic dynamics, including the importance
of age and stage structure [e.g. @Cohen1979; @Tuljapurkar1989; @Tuljapurkar1997;
@Caswell2009; @Metcalf2015; @Vindenes2017b], spatial structure [e.g.
@Durrett1994; @Dieckmann2000; @Kerr2002; @Schreiber2010], Individual
heterogeneity [e.g. @Vindenes2015; @Hart2016] or the coexistence
of multiple species [@Caswell1978; @Tuljapurkar1980; @Chesson1981;
@Chesson1982; @Chesson1985; @Chesson1989; @Melbourne2007;
@Schreiber2017]; correlated [@Ripa; @Ripa1999; @Petchey, @Schreiber2010;
@Lee2017; @Spanio2017] or periodic [@Coulson2001; @Bjornstad2001;
@Keeling2001] structure in environmental noise, or the interaction
of ecological and evolutionary processes [@Saether1997; @Ozgul2009;
@Lenormand2009; @Vindenes2015; @Schreiber2015].  As such, we will 
rely on both textbooks and recent reviews to provide a proper treatment
of these issues, and focus on broader trends that may be less apparent
to non-specialists.

This review is structured into three sections: Origins of noise, emergent
phenomena, and noise-driven inference.  The first section lays the conceptual
groundwork we will need, while also highlighting a shift to more and more
mechanistically rooted descriptions of noise.  We will see where the common
formulation of 'deterministic skeleton plus noise term' comes from, how it 
is best justified, and when it breaks down.  The second section introduces
"noise the creator," showing examples of ecological phenomena generated by
stochasticity.  These examples will be familiar to most specialists but
illustrate a different way of thinking than held by most ecologists, where
noise is only a nuciance to be filtered or averaged out.  The third and
final section, "noise the informer," turns these examples back-to-front, 
asking what noise can tell us about a system: such as its underlying resilience
or stability, or the approach of a catastophic shift. Examples are fewer
here, and have largely yet to benefit from the introduction of either
the rigorous theorems or more complex models so plentiful in the previous
sections.  Yet the promise of prediction, of early warning signs before
tipping points, have spurred broad interest in such noise-based inference.
This review is a call to both deepen the connection to mechanism and better
formalize this thinking, but also look more broadly into other ways in which
noisy phenomena can help inform and predict underlying processes.




<!--
I approach this synthesis in three parts.  First, I will sketch the ground-work
for the origins of noise in any model as statistical summary of large number of
additional processes from some lower level that are modeled only in aggregate.
This will provide the fundamentals we need to illustrate several key examples
of noise driven phenomena in ecological dynamics: noise the creator.  Finally,
we will be able to invert some of these examples; instead of going from process
to pattern, we will go from pattern to process: noise the informer.  
-->




# Origins of noise

What is noise? Where does it come from? 
Many stochastic models are not explicit about whether the noise terms
they introduce are intended to reflect intrinsic or extrinsic factors.
Early quantitative ecological models first formulated at the population
level in deterministic settings. The notion of a deterministic
"skeleton" -- responsible for the phenomena of interest -- that is obscured
from view by the nuisance of noise has slowly given way to recognition
that stochastic and deterministic elements not only interact in 
interesting ways [@Coulson2004] but also share a common origin [e.g. @Black2012].
A central theme of stochastic modeling research over the past
several decades has been an emphasis on making this relationship
between stochasticity and underlying processes more precise:
that is, on the origins of noise. 

Simply put, noise is all that we leave out of our model. 
Whenever stochasticity is introduced into a model, it
is only as a simplification or summary of the effects of a large
number of other processes, often occurring at different scales.
This literature has largely divided the origins of stochasticity between 
*intrinsic* factors: where stochasticity is introduced to reflect
the reality that our variables of interest are intrinsically 
statistical averages of lower-level processes, and *extrinsic*
factors: where stochasticity reflects the impact of other variables
we are not explicitly modeling at all [e.g. @Keeling2012].  **Demographic stochasticity**
is the primary (though not the only) example of an intrinsic factor,
which reflects the fact that the continuous variable we often think of a
"population size" or "population density" is an average over a 
lower level process of births and deaths among a finite number of 
individuals [@Melbourne2012].  **Environmental stochasticity** is the primary example 
of an extrinsic factor, reflecting the fact that parameters we may
treat as constants in a model in fact depend on variables such as 
temperature or soil moisture that are not explicitly modeled by our 
equations, but simplified into statistical summaries of those processes
[@Ripa2012]. 

It is often suggested that stochasticity is "inherent" or "fundamental,"
e.g. "demographic stochasticity arises because the birth of an individual is probabilistic"
[@Melbourne2012]. It is easy to forget that this is merely an assertion about a 
model, not an assertion about reality [@Bartlett1960].  Only in quantum mechanics do we find 
inherently probabilistic properties: births and deaths of organisms all have
far more mechanistic explanations which we simply summarize in statistical terms:
on average -- that is, summing over a wide range of possible mechanisms we have chosen
not to explicitly model -- an individual death occurs at rate $\lambda$.  
This is in fact an extrinsic factor (variables not modeled explicitly),
which makes birth appear probabilistic; (just as we describe the toss of a coin
as probabilistic when in fact it is a mechanistic outcome of Newton's laws).  
Demographic stochasticity arises only subsequently, when we change scales from
a description at the individual level to one at the population level.


In the extensive literature developing the consequences of both demographic
and environmental noise in models of increasing complexity, it can 
be easy to miss the equally important developments in making the origins
of these sources of noise more precise. Models in which stochasticity was
essentially "tacked on" to a deterministic skeleton can be substituted for 
approaches that permit both the skeleton and noise to emerge from underlying
processes.  This more mechanistically specific approach to the origins of 
noise can indeed recover the classic formulations, but it can also 
help highlight where those models break down.
Much of the literature [e.g. see @Ovaskainen2010] has focused on the following
model, established in highly influential papers of @Leigh1981, @Lande1993,
@Foley1994:



\begin{equation}
\textrm{d} N_t = \underbrace{f(N_t) \textrm{d} t}_{\textrm{det skeleton}} + \underbrace{\sigma_d \sqrt{N_t} \phantom{\cdot}\textrm{d}B_t^{(d)} }_{\textrm{demographic noise}} + \underbrace{\sigma_e N_t \phantom{\cdot}\textrm{d}B_t^{(e)}}_{\textrm{environmental noise}} 
\label{canonical}
\end{equation}



Where $\textrm{d}B_t^{(d)}$ and $\textrm{d}B_t^{(e)}$ refer to Brownian processes, (i.e. Gaussian white noise process) for demographic and environmental stochasticity respectively.  When $f(n)$ is simply a Verhulst logistic function this is often referred to as the canonical model [e.g. @Ovaskainen2010], and provides a clear illustration of the partition of separate deterministic and stochastic elements. Significant research continues to focus on extending the study of this model to consider more complex and higher-dimensional $f(n)$ (coexistence models, stage structured models) and consider the case of auto-correlated, rather than than white noise of $\textrm{d}B_t^{(e)}$.  

Before we follow that path, we will examine how this canonical model can emerge from a lower-level description and how it can deviate from that description. This approach will also set the stage to see how our understanding of stochastic models can be extended to better reflect natural processes that shape not only for the so-called deterministic skeleton, but the noise as well.  In so doing, I will highlight two tools fundamental to this analysis, one computational and one analytical: the exact simulation method of @Gillespie1977's stochastic simulation algorithm (SSA), and the van Kampen system size expansion [@vanKampen1976].




## Demographic stochasticity


Demographic stochasticity refers to fluctuations in population sizes
or densities that arise from the fundamentally discrete nature of
individual birth and death events.  Demographic stochasticity is a
particularly instructive case for illustrating a mechanism for how
noise arises as an aggregate description from a lower-level mechanistic
process.  We summarize the myriad lower-level processes that
mechanistically lead to the event of a 'birth' in the population
as a probability: In a population of $N$ identical individuals at
time $t$, a birth occurs with probability $b_t(N_t)$ (_i.e._ a rate
that can depend on the population size, $N$), which increases the
population size to $N+1$. Similarly, death events occur with probability
$d_t(N_t)$, decreasing the population size by one individual, to $N-1$.  Assuming
each of these events are independent, this is a state-dependent
Poisson process. The change in the probability of being in state
$N$ is given by the sum over the ways to enter the state, minus the
ways to leave the state: a simple expression of probability balance
known as the "master equation" [@vanKampen2007].  Note that in general
this approach is equally applicable to stochastic transitions of any sort,
not just step sizes of +/- 1 and not just birth and death events, but
can include transitions between stage classes or trait values, including
mutations to continuously-valued traits in evolutionary dynamics [e.g. @Boettiger2010]. 


The @Gillespie1977 provides an exact algorithm
for simulating demographic stochasticity at an individual level.  
The algorithm is merely a simple and direct implementation of the master
equation, progressing in random step sizes determined
by the waiting time until the next event.
Free from both the approximations and mathematical complexity,
the Gillespie algorithm is an interesting example of where we rely on a
numerical implementation to check the accuracy of an analytic approximation,
even in the case of simple models such as we will discuss.  Though the 
algorithm is often maligned as numerically demanding, it can be run much
more effectively even on large models on today's computers than when
it was first developed in the 70s, and remains an underutilized approach
for writing simple and approximation-free^[that is, free from the approximation
made by SDE models as we see in the van Kampen example.  All models are, of course,
only approximations.] stochastic ecological models. 


As our objective is to tie the origins of noise more closely to biological
processes, it will be helpful to make the notion of a master equation concrete
with a specific example.  We will focus on the classic case of @Levins1969 patch model,
to illustrate the Gillespie algorithm and the van Kampen system size expansion

\begin{align}
\frac{\ud n}{\ud t} = \underbrace{c n \left(1 - \frac{n}{N}\right)}_{\textrm{birth}} - \underbrace{e n}_{\textrm{death}}, \label{levins}
\end{align}

where $n$ individuals compete for a
finite number of suitable habitats $N$.  Individuals die a constant
rate $e$, and produce offspring at a constant rate $c$ who then
have a probability of colonizing an open patch that is simply
proportional to the fraction of available patches, $1 - n/N$.  


We choose this model because it has precisely same functional form
as the ubiquitous logistic growth model, $\frac{\ud n}{\ud t} = rn (1 - \tfrac{n}{K})$
but is explicit about how this net growth rate is divided between
birth and death rate.  As we shall see, this is not merely a notational
convenience but leads to real differences in observed stochastic properties
of the model. Both the numerical approach (details in Appendix A) and the 
analytical approach (Appendix B) illustrate that it is straight-forward
to use this same approach in alternate formulations.  

Figure \ref{gillespie} shows the results of two exact SSA simulations of this model with
identical parameters except for the total number of available sites,
$N$, illustrating the magnitude of these fluctuations indeed scales in proportion
to $\sqrt{N}$ as postulated by the canonical equation, Eq \eqref{canonical}.

<!-- Figure 1: Gillespie simulations -->
```{r gillespie, warning=FALSE, fig.width=7, fig.cap="Population dynamics from a Gillespie simulation of the Levins model with large (N=1000, panel A) and small (N=100, panel B) number of sites (blue) show relatively weaker effects of demographic noise in the bigger system. Models are otherwise identical, with e = 0.2 and c = 1 (code in appendix A). Theoretical predictions for mean and plus/minus one standard deviation shown in horizontal re dashed lines. \\label{gillespie}"}
read_csv("../appendixA/gillespie.csv", col_types = "cdiddd")  %>% 
  mutate(system_size = recode(system_size, large = "A. 1000 total sites", small= "B. 100 total sites")) %>%
  ggplot(aes(x = time)) + 
  geom_hline(aes(yintercept = mean), lty=2, col=colours[2]) + 
  geom_hline(aes(yintercept = minus_sd), lty=2, col=colours[2]) + 
  geom_hline(aes(yintercept = plus_sd), lty=2, col=colours[2]) + 
  geom_line(aes(y = n), col=colours[1]) +
  facet_wrap(~system_size, scales = "free_y") 
```


The van Kampen system size expansion provides a mechanism to approximate the individual
dynamics represented by the master equation (equivalently, by the Gillespie simulation)
with a population-level description of the process.  This is important not only because
it will illustrate both origins and approximations that lie behind the population level
models that predominate this literature, but will give our syntheses a chance to point
out some more subtle misconceptions that have also arisen. Details of this expansion
for a generic birth death process and comparison with the more familiar diffusion 
approximation are found in Appendix B.  

van Kampen's approximation follows a central-limit theorem style argument established rigorously in
the theorems of Kurtz at about the same time [@Kurtz1970 & @Kurtz1971, @Kurtz1972, in particular, see Theorem 4.4. @Kurtz1978].
The heart of the approximation is to imagine a population on some large landscape of which
we sample only a fixed area to estimate the population density.  That area is our 
system size, which as it expands includes more and more total individuals and
experiences proportionally smaller fluctuations in population density.  This 
results in the conclusion that the population density obeys a simple Gaussian
distribution, whose mean size $x$ and variance  $\sigma^2$ are given by *ordinary* differential equations:


\begin{align}
\frac{\mathrm{d} x }{\mathrm{d} t}  &= b(x) - d(x) + \mathcal{O}(N^{-1})\\
\frac{\mathrm{d} \sigma^2 }{\mathrm{d} t}  &= 2 \partial_x  \left[ b(x)  - d(x) \right] \sigma^2 + b(x) + d(x)  + \mathcal{O}(N^{-\tfrac{1}{2}}) \label{vanKampen}
\end{align}

This result is striking for a variety of reasons.  First, we see the recovery of the 
"deterministic skeleton," in which we naively replace population density $x/N$ for
population count $n$ describes the *expected* density of the population
(i.e. averaged over an ensemble of replicate realizations of the Gillespie simulations),
and with remarkable accuracy, up to order $1/N$, i.e. a single individual.^[We can actually extend the van Kampen expansion to higher order and successfully approximate even this higher-order correction to the mean dynamics, recovering the phenomenon of stochastic inflation [@Gonzalez2002], where the average population size can be larger or smaller than predicted by the deterministic model depending on the curvature of the macroscopic equation].
The variance term is equally interesting.  First, we note that noise arises from
the interaction of individual birth and death events that defined our process,
illustrating the origins of this noise.  Because both individual events of births
and deaths add randomness, they both add to the growth of variation observed, i.e.
$b(x) + d(x)$.  Second, we see that dynamics for the variance $\sigma^2$ are *non-linear* whenever
$b(x)$ or $d(x)$ are non-linear, so that different values of the population density
will experience different noise intensities! In fact, this variance can only
have an equilibrium size if the macroscopic equation has an equilibrium ($\partial_x  \left[ b(x)  - d(x) \right] < 0$)
Third, this expansion shows the variance
equation is also less precise, accurate only to order $1/\sqrt{N}$. 
This variance equation will be important to us later as we examine the relative
roles of noise and non-linearity in noise-driven phenomena such as stochastic
transitions between alternate stable states.  

The expected auto-correlation, $\langle x_0, x_t \rangle$ also follows from the
system size expansion, e.g. at stationary state:

$$\langle x_0, x_{t} \rangle = \frac{b(x) + d(x)}{2 \partial_x \left[ b(x) - d(x) \right]} \exp\lbrace  -t \left| \partial_x b(x) - \partial_x d(x) \right|  \rbrace $$
which will also prove useful later on.  Note this expression simply states that the equilibrium
variance is a balance between noise terms, $b(x)+ d(x)$ and the slope or eigenvalue of the
deterministic skeleton, $2 \partial_x \left[ b(x) - d(x) \right]$, (a balance that forms the basis of the
the fluctuation-dissipation theorem) and that correlations fall off exponentially at a rate given by this slope.   
We will see both auto-correlation and variance play similar roles to infer this eigenvalue when we 
reach the role of noise as informer.  

In the interests of a theoretical synthesis, I observe that this result
is *different* than the canonical equation, Eq \eqref{canonical}, or more generally
the diffusion approximation [or Kramer-Moyal expansion @Kramers1940; @Moyal1949; @Gardiner2009]
which is much more typical in the ecological literature [e.g. the books of @Nisbet1982 and @Lande2003
or the review in @Ovaskainen2010]. @Black2012 gives an excellent introduction 
to the van Kampen expansion as a connection between individual-based and population-level
model descriptions and applications, but fails to point out these differences,
mistakenly characterizing the van Kampen expansion as synonymous with the diffusion approximation.
In brief, the diffusion approximation does not lead to a Gaussian distribution
(equivalently, an SDE or PDE with linear noise term, see Appendix B), but rather
a *non-linear* SDE of the form (e.g. @Ovaskainen2010)


\begin{equation}
\ud X_t = \left[ b(x) - d(x) \right] \ud t + \sqrt{b(X_t) + d(X_t)} \ud W_t \label{diffusion}
\end{equation}

This better-known approach has several potential draw-backs.  First, as noted in @vanKampen2007 or
@Gardiner2009 (see Appendix B), the Kramer-Moyal expansion approach rests on rather
a more dubious double limit that often has no clear biological interpretation and
can restrict its validity (though I believe theorem 3.3 of @Kurtz1978 establishes
this approximation on firmer grounds).  Second, the non-linear SDE formulation can
prove more difficult to work with than the convenient ODE expressions from van Kampen,
Eq \eqref{vanKampen} (which can be expressed as a coupled ODE for the mean and 
a linear SDE for deviations).  Third, while both approximations break down
in the case of large deviations [see @Ovaskainen2010], the van Kampen expansion
shows that the macroscopic equation will continue to hold even when the 
variance does not; in contrast to the non-linear SDE from the diffusion approximation.

Applying the system size approximation to the example of the Levins model introduced
previously lets us both recover the classic model while adding some nuance in 
the interpretation.
Taking $b(n) = n (1 - \tfrac{n}{N})$ and $d(n) = en$ and solving for the steady
state to van Kampen's ODEs, we see the average number $\langle n \rangle$  of occupied patches is
$\langle n \rangle = N\tfrac{e}{c}$ with variance at steady-state of 
$\sigma^2_n = N \tfrac{e}{c}$.  Observe that the variance scales proportionally
to the system size, $N$, which explains the standard deviation
increases as $\sqrt{N}$, as in the canonical model and as predicted by Figure \ref{gillespie}.  
We can also see that different ways of partitioning the same macroscopic equation
into components of birth and death will create the same mean dynamics
but with *different* levels of noise.  For instance, in a logistic
model with $b = rn$ and $d = rn^2/N$, we instead find the variance
at steady state is $\sigma^2 = K$; significantly larger than in the
Levins model.



## Environmental stochasticity

The van Kampen expansion can also be useful in illustrating how extrinsic
factors such as environmental noise enter into a stochastic model.
Like the expansion of demographic noise, this derivation leads to 
environmental noise that is approximately Gaussian in distribution,
but unlike the canonical model, leads to explicitly auto-correlated noise 
(see derivation, Appendix B).  Auto-correlated or "colored" environmental
noise has been a topic of significant theoretical interest 
[e.g. @Roughgarden; @Ellner; @Lawton; @Ripa1999; @Marshall2015], but such 
formulations start from the empirical observation of auto-correlation 
in environmental time series rather than a process-based derivation.
As the expansion clearly shows, any bounded continuous-time process will
involve auto-correlation -- measure a continuous process at ever-closer intervals in
time and these measurements must converge. As the derivation in Appendix B makes clear,
it is rather the the *relative* time scales of the environmental process
and population level process that really matter (more precisely, the relative 
magnitudes of the auto-correlation time of the environmental dynamics and population dynamics.)
An environment with comparatively short auto-correlation scale will act
effectively as white noise upon the population dynamics.  



The van Kampen expansion for extrinsic factors (appendix B) also highlights
the importance of how environmental noise couples to the population dynamics.
A mechanistic description of environmental noise acts directly on parameters
of the ecological model: for instance, in our Levins' model we may imagine
that the extinction rate of patches does not occur at some fixed rate $e$
but rather at some stochastically fluctuating rate of a given mean, variance,
and auto-correlation.  The system size expansion illustrates how we replace
a model where stochasticity is nested inside some parameter into the simpler
format of the canonical equation where this contribution can be merely added
on as Gaussian noise at the end of a deterministic skeleton.  (The expansion
derives that the environmental noise is proportional to the square of the derivative
of the deterministic skeleton with respect to the environmental variable,
see appendix B.) Thus for the Levins' model, we can capture the fluctuations
introduced by demographic and environmental noise at equilibrium as
a Gaussian distribution with variance given by the sum of of demographic
and environmental contributions:

$$\sigma_n^2 = \frac{\bar e}{c}N + \frac{\left[(1-\frac{\bar{e}}{c}) N\right]^2}{(\bar e - c)^2} \sigma_e^2$$

where $(1-\frac{\bar{e}}{c}) N$ is the equilibrium population size.
This reflects the assumption of the canonical equation, Eq \eqref{canonical}
that the standard deviation (e.g. square root of the variance) scales in direct proportion to the system size $N$,
while the demographic noise scales as the square root.  Consequently,
for a large system, the demographic contribution becomes proportionally smaller
while the environmental contribution remains the same. 

These examples of how a stochastic model arises from both intrinsic and extrinsic
sources of noise through the use of the system size expansion serve both
as critique and justification of the familiar notion of a stochastic model as 
a deterministic skeleton plus some Gaussian white noise term.  Critique, because
the expansions show that both "noise" and "deterministic skeleton" are the 
result of lower-level mechanistic processes, whose precise form will 
depend on the details of those processes.  Yet the expansion also shows us that
this Gaussian noise description can be a surprisingly good approximation,
that noise intensity will converge to a stationary value whenever the system
dynamics have a stable point, and that the contribution of extrinsic
(i.e. environmental) noise factors will dominate in large systems.  These
justifications will allow us to pursue our analysis of noise-driven phenomena
using simple models in which a nonlinear deterministic skeleton is driven by
Gaussian environmental noise. 



<!-- This can be condensed or dropped to save space -->

## Origins of other forms of stochasticity

Stochasticity frequently enters our models in other ways as well.
For instance, most population-level models treat all individuals
within the population, or at least within a particular age or stage
class, as identical.  *Individual heterogeneity* in relevant traits
(growth rates, dispersal ability) can be represented probabilistically
as a distribution rather than a fixed value, making it function as
another form of random variation in a model [@Coulson2001;
@Schreiber2010; @Vindenes2015].  *Spatial heterogeneity* can likewise be reflected
in stochastic parameters of a spatially implicit model, or as
spatially varying environmental stochasticity in a spatially explicit
model.  As with other forms of noise [@Melbourne2008; @Bonsall2004],
interaction between individual or spatial variation and other sources
of noise can drive patterns including the potential for persistence,
coexistence, and dispersal of species [@Schreiber2010; @Hart2016;
@Schreiber2017].  


*Observational error* acts
much like another form of stochasticity, arising from sampling
effects or limitations of instruments, etc. Yet unlike the sources
described above, this uncertainty does not impact the actual state
of our system, and thus does not give rise to any additional phenomena
or information about that process, though it can obscure it
[@Knape2011; @deValpine2002].
*Deterministic chaos* [@Desharnais2001] is another mechanism of introducing
significant variation into a simple model. Chaos can a look a lot
like noise: indeed, it can be observationally indistinguishable
from a stochastic process [@Ellner2005; @Werndl2009].  Despite
substantial interest in previous decades and the relative ease of
encountering chaos in simple ecological models (particularly in
differences equations), and convincing reconstructions of chaotic
dynamics in laboratory manipulations [@Costantino1997] the prevalence
of chaotic dynamics as a driving factor in most ecological systems
remains unclear. After all, the great variation of natural populations
is hardly surprising: the undeniable influences of variation created
by all those things left out of our models, all that individual
detail from intrinsic, lower level processes and external environmental
processes that becomes aggregated in our simple models all but begs
for a stochastic description.


# Noise the creator: Noise can induce novel phenomena

Outside of the primarily theoretical literature on stochastic dynamics
in ecology, noise is viewed largely as a nusiance: something entirely
distinct from the processes we are interested in which invariably keeps
getting in the way.  As we have seen in section on origins, such 
characterizations are misleading: noise arises from the very same processes.
While both empirical and statistical literature have frequently emphasized
techniques to remove noise, a central theme of stochastic processes
have emphasized an almost opposite conclusion: noise cannot be subtracted or
averaged away, since tthe presence of noise can fundamentally alter the
dynamics we observe.
Stochasticity can give rise to a wide array of interesting phenomena
that are often at odds with our intuition. As these examples will
illustrate, such behavior arises through an interaction between
stochastic and non-linear elements of a system, underscoring the
importance of explicitly including stochasticity in ecological
models [@Coulson2004; @Higgins1997].  Importantly, the noise itself
does not have to be large to give rise to these phenomena.  In this
section, I highlight several examples that have shown up frequently
in the literature and prove sufficiently tractable to provide a
simple intuition for the mechanisms involved.

## Persistence and coexistence  

The loss of a species is without a doubt one of the most important
possible consequences of noise. Unsurprisingly few topics have
received greater attention then the question of the persistence of
a given species [e.g. @Kendall1949;  @Bartlett1955; @Bartlett1960;
@Lande1993; @Saether1998; @Coulson2001; @Schreiber2010] and coexistence
of multiple species [@Caswell1978; @Tuljapurkar1980; @Chesson1981;
@Chesson1982; @Chesson1985; @Chesson1989; @Melbourne2007; @Hart2016; @Schreiber2017]
in stochastic models.  Two important trends in this literature have
been establishing existing results in more general and precise language
and theorems [e.g. see @Schreiber2012 and @Schreiber2017 for an excellent
overview and synthesis of persistence and coexistence respectively],
and continuing to extend such results to more complex contexts 
[@Ovaskainen2010 provides one excellent review], in
particular addressing auto-correlated noise [e.g. @Ripa; @Ripa1999; 
@Petchey, @Schreiber2010; @Lee2017; @Spanio2017] , spatial structure
[e.g. @Durrett1994; @Hastings1994; @Dieckmann2000; @Kerr2002; @Schreiber2010] and stage structure
[e.g. @Cohen1979; @Tuljapurkar1989; @Caswell2009; @Metcalf2015; @Vindenes2017b], 
among other issues.

Demographic noise in particular has fundamental implications for the long-term
equilibrium: any finite population, however big, is guaranteed to
eventually go extinct under demographic noise [e.g. @Kendall1949; @Lande2003].  
In most models it is possible [@Schreiber2006] to define a notion of quasi-stationary 
distribution concentrated around the deterministic attractor,
and to prove the probability of extinction decreases exponentially with 
system size [@Ovaskainen2010; @Schreiber2017]. We will turn our attention
away from the well-trodden ground of persistence and coexistence to focus
on other phenomena that can emerge in stochastic models.  This will
highlight the importance of noisy phenomena beyond the ability to obscure
a deterministic skeleton of some underlying process or in driving extinctions,
but rather in shaping and driving other interesting patterns we observe in
natural systems. It is these phenomena that will also underpin the third
transition in which noise can be turned to our advantage as a source
of information about ecological processes.


<!--

Insufficient space left for any treatment of these...
Permenance, robust permenance

**Bet hedging**, @Lewontin1969 & Cohen 1969; Levins 1969; 

-->


<!-- Figure 2: Quasi-cycles -->
```{r quasicycles, fig.width=7, fig.cap="Panel A: under negligible environmental noise, the introduction of a carrying capacity damps Lotka-Volterra oscillations which eventually settle to a stable state.  Panel B: small noise induces quasi-cycles in the same model: sustained long-term oscillations predominately around the natural frequency of the original damped oscillations. Parameters for models shown are r = .1, K = 5,  b = .1, c = .1, d = .1, N = 800; code in Appendix A. \\label{quasicycles}"}
fig2 <- read_csv("../appendixA/quasicycles.csv") %>%
  gather(species, population, -t, -sigma) %>%
  mutate(sigma = as.factor(sigma)) %>%
  mutate(sigma = recode(sigma, "1e-05" = "A.", "0.01" = "B.")) %>%
  rename(time = t) %>%
  ggplot(aes(time, population, col = species)) +
  geom_line() + 
  facet_wrap(~ sigma, ncol=2) + 
  scale_color_ptol() +
  theme(legend.position = "none")

fig2c <- ggplot() + 
  annotation_raster(readPNG("figures/resonance-bjornstad2004.png"), 
                    xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf) +
  labs(subtitle = "C.")

gridExtra::grid.arrange(fig2,fig2c, layout_matrix = rbind(c(1,1,2)))

```


## Quasi-cycles 

<!-- Justify and contrast models to individual noise -->

Understanding the origin of sustained oscillations has long been a
central question in ecology [@Hastings1996; @Kendall1999;; @Bjornstad2001].  The
simple Lotka Volterra model produces only neutrally stable centers,
while the more realistic model that introduces carrying capacity
for prey as they compete for resources results in a model that
produces only damped oscillations, eventually settling into a stable
state (Figure \ref{quasicycles}A).  However, the introduction of relatively small
noise into the system can be sufficient to excite the system into
sustained oscillations (Figure \ref{quasicycles}B) 
[empirical discussed in @Greenman2003; @Bjornstad2004; @Black2010].  

@Nisbet1976 first identifies the potential for quasi-cycles to explain
sustained oscillations in a simple predator prey model with stochastic
forcing, which provides a familiar formulation for us to illustrate
the phenomena. Consider a predator-prey system is driven by environmental 
white noise $\xi_t$ (e.g. as we have seen arise from stochastic growth rates), 
with prey following the equation:

$$x_{t+1} = x_t + x_t r \left(1 - \frac{x_t}{K}\right) - b x_t  y_t + \xi_{x,t}$$
where $x_t$ is the prey density at time $t$, $r$ the growth rate, $K$ the carrying capacity, $b$ an encounter rate with the predator $y$, who obeys the equation:

$$y_{t+1} = y_t + c  x_t  y_t - d  y_t+ \xi_{y,t}$$

with $c$ the conversion ratio and $d$ the predator mortality rate.  Here we have assumed for the prey, $\xi_x \sim \mathcal{N(0, \sigma_x)}$, and similarly for the predator driven by $\xi_y$. Figure \ref{quasicycles}A shows examples for noise $\sigma_x = \sigma_y = 10^{-5}$, while Figure \ref{quasicycles}B shows $\sigma_x = \sigma_y = 0.01$.  


Oscillations arise through the process of stochastic resonance.
The damped oscillations seen in Figure \ref{quasicycles}A are analgous to a child
sitting still on a swing: friction slowly damps the magnitude of
each successive oscillation, while the period of pendulum remains
unchanged.  Driving the pendulum through perturbations timed to
match that natural period can quickly create sustained oscillations
with large magnitudes, but such perfect timing is not required.  In
the model above, white noise effectively drives the pendulum at all
frequencies, though at very low magnitude, since the noise is small
relative to the scale of the dynamics.  However, frequencies that
most closely match the natural period of the damped oscillator are
amplified, resonating with the natural oscillations.  This process
is sufficient to permit even small noise to drive sustained
oscillations in the model indefinitely.  The power spectrum (the
squared norm of the Fourier transform, a measure of what frequencies
are present; see, e.g. @Black2012) provides a convenient way to
visualize the effects of these oscillations.  The power spectrum
for a deterministic limit cycle would create a perfect sinusoidal
oscillation and a resulting power spectrum of a delta spike at that
single frequency.  The power spectrum for the quasi-cycle instead
shows a distribution of frequencies, centered at the the resonant
frequency of the damped oscillator.


Since @Nisbet1976, examples of stochastic resonance have been demonstrated in common
models and implicated in empirical examples of increasing complexity [@Greenman2003].
@Blarer1999 identified quasi-cycles as a possible
explanation for oscillations and periodic outbreaks in pest ecosystems.
@Bjornstad2004 analyzes the potential for such stochastic effects
to drive cyclic behavior in population abundances of Atlantic bluefin
tuna and Atlantic Cod.  @McKane2005, @Alonso2007, and @Black2010 illustrate
the emergence of quasi-cycles in common disease outbreak models, including
the use of power spectrum analysis.  
@Pineda-Krch2007 compare patterns from stochastically generated cycles to
stable limit cycles they resemble to ask how we can discriminate between
these mechanims.  Stochastic resonance highlights
one way in which even small noise can play an important role in
driving large scale patterns where we had previously only sought
deterministic explanations. This example also illustrates the
interplay between nonlinear dynamics and stochasticity that is the
hallmark of stochastically driven phenomena.  A stable node with
linear dynamics, such as an Ornstein-Uhlenbeck process, has no
resonant frequency, and could not produce sustained oscillations
(unless the environmental driver itself had a periodic pattern)
[e.g. @Gardiner2009; @Black2010].

<!-- See additional citations in Coulson2004 and others that mention stochastic resonance --> 
<!-- [@Keeling2001; @Coulson2004;]  -->

## Stochastic switching

We turn from stochastic resonance to oscillations of a very different
sort, which do not resemble any deterministic process, as seen in
Figure \ref{noisy_switch}A.  This pattern is characterized by long stretches during
which fluctuations in the state variable remain concentrated around
a high average value followed by sudden, rapid transitions into
fluctuations concentrated around a lower value.  This behavior
arises through the interaction of stochasticity and alternative
stable state dynamics.  The simulation shown in Figure \ref{noisy_switch}A for the
is based on an resource consumption model first proposed by @May1977
as one of the early examples of the potential for alternative stable
state dynamics.  The resource grows according to a logistic growth
model and is consumed according to a Holling Type-III functional
response curve, to which I have simply introduced the addition of
environmental noise:

$$X_{t+1} = X_t + \underbrace{X_t r \left(1 -\frac{X_t}{K} \right)}_{\textrm{ growth, } g(X_t)}  - \underbrace{\frac{a X_t ^ Q}{X_t^ Q + H ^ Q}}_{\textrm{consumption, } c(X_t)} + \xi_t,$$

where $\xi_t$ is normally distributed environmental variation with
mean zero and standard deviation $\sigma$. Figure \ref{noisy_switch}B shows separate
curves corresponding the parts of the model describing vegetation
growth and vegetation consumption, using the same parameters as
shown in the simulation panel, 3A.  Equilibria exist whenever growth
balances consumption.  For the parameters shown, the S-shaped curve
of the Type-III consumption pattern crosses the quadratic curve of
logistic growth at four separate locations.  When growth is larger
than consumption before the crossing, and thus smaller after, the
point is stable, otherwise it is unstable.  Consequently, we can
see two stable points, in the neighborhood of $X_t \approx 1.2$ and
$X_t \approx 0.5$, closely matching the average fluctuations seen
in the simulation in 3A.  Stochastic fluctuations drive spontaneous
shifts between these alternative stable states.

The concept of a potential well, Figure \ref{noisy_switch}C, is often invoked when
describing the behavior of alternative stable states.  The curve
for the potential well, $U(x)$ is defined as the negative integral
of the population growth rate,

$$U(x) = -\int_0^x f(y) \textrm{d} y $$ 

where in our model $f(y)$ is vegetation growth minus consumption,
$f(y) = g(y) - c(y)$.  The motivation comes from physics, where $f$
is a force and $U$ the corresponding potential energy.  This suggests
a convenient analogy to gravity, often implied by drawing a ball
inside the curve and referring to this as a "ball-in-cup" diagram.
The potential function is particularly instructive for understanding
stochastic switching under small noise, as in our simulation in
Figure \ref{noisy_switch}, where it is straight-forward to show [e.g. @Feller;
@vanKampen2007] that the probability of a transition is proportional
to the exponential of the depth of the well from the lowest point to
the separation barrier, (a result that is familiar as Arrhenius law
of activation energy to grade-school students of chemistry).  This
effect is visible even in the short simulation shown in 3A, which
spends longer times in the lower state which has the deeper well.
(Readers are encouraged to experiment with this by adjusting the
parameters of the simulation in the included code).  Unfortunately,
the literature is not always careful in describing how this potential
well diagram arises, which has caused it to become a source for as
least as much confusion as it is of insight.  While the curves in
Figure \ref{noisy_switch}B can be clearly associated with underlying mechanisms of
rates: logistic growth and consumption with handling time, the same
is not true of the potential: it is much harder to have a good
intuition about the 'negative integral of the difference growth and
consumption,' and how it would change in response to, say, a larger
carrying capacity $K$ or higher consumption rate $a$.  While the
x-axis of the potential diagram remains the same: the system state,
the conceptual problem is clearly evident in the usual ambiguity
describing the y-axis in such ball-in-cup models.


<!--Figure 3: Noisy switch -->
```{r noisy_switch, fig.width=7, fig.height=7, fig.cap="Stochastic switiching in May's model of alternative stable state dynamics.  r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 10000. \\label{noisy_switch}"}

p <- list(r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 1e4)

theory <- 
  tibble(x= seq(0,2, length.out = 100)) %>%
  mutate(g = x * p$r * (1 - x / p$K), 
         c = p$a * x ^ p$Q / (x^p$Q + p$H^p$Q)) %>%
  mutate(potential = - cumsum(g - c)) %>%
  gather(curve, y, -x, -potential) 

p0 <- ggplot() + 
  annotation_raster(readPNG("figures/switching-keeling2001.png"), 
                    xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf) +
  labs(subtitle = "A.")

p1 <- read_csv("../appendixA/noisy_switch.csv")  %>%
  ggplot(aes(t,x)) + 
  geom_line(lwd=.1, col=colours[[1]]) +
  labs(subtitle = bquote(bold(B.)))

p2 <-  theory %>%
  ggplot(aes(x, y, col=curve)) +
  geom_line(lwd=1) + 
  scale_color_ptol() + 
  labs(x = bquote(X[t]), y = bquote(X[t+1]), subtitle= bquote(bold(C.))) +
  theme(legend.position="top")

p3 <-  theory %>%
  ggplot(aes(x, potential)) + 
  geom_line(col=colours[1], lwd=1) + 
  coord_cartesian(xlim=c(0,1.6), ylim=c(-1.15,-0.9)) + 
  labs(subtitle = bquote(bold(D.)))


gridExtra::grid.arrange(p0,p1,p2,p3, layout_matrix = rbind(c(1,2), c(3,4)))
```


Despite the nearly ubiquitous association of a ball-in-cup model
with ecological discussions of resilience and stability, this
potential well diagram (Figure \ref{noisy_switch}C) is also a source of confusion
on the topic.  As we have seen, the most salient feature of this
diagram is the depth of each well: transition probabilities (under
small noise) depend only on the depth of the well and not the
steepness of the well, the distance between the wells or between
well and tipping point barrier.  However, it is important to remember
that because the potential function is defined by the above integral,
it in fact already combines two more elementary and mechanistically
precise quantities from the growth equation: the slope of the growth
rate (stability) and the distance to the tipping point (size of the
basin of attraction).  Both a steeper negative slope or a longer
distance to integrate over between stable and unstable points will
create a deeper well.

Empirical evidence for stochastic switching in ecological timeseries
is limited by the long time scale usually required 
[but see @Keeling2001; @Clements2016; @Clements2017]. Because a single
stochastic transition between alternative stable states appears as
such a dramatic deviation from the previous pattern (as illustrated
in Figure \ref{noisy_switch}A), it is often tempting to assume the change could only
be the result of some sudden external force or change in the
environment, so it is worth remembering that given long enough,
these transitions can happen entirely by chance stochasticity
[@Boettiger2012; @Drake2013]. However, these transitions are most
likely to observed in systems with relatively shallow potential
wells.  This is mostly likely to occur of some external change is
slowly making the potential well shallower and thus transitions
more likely -- a phenomenon that has become to be known as "flickering"
and suggested as a potential early warning sign of an approaching
transition [@Brock2010].  Examples of flickering between alternative
stable states have been suggested in data ranging from geological
timescales at the end of glaciation in the Pleistocene [@Taylor1993]
to ecological scales over a few decades in lake ecosystems [@Wang2012].
Stochastic transitions between bi-stable states are thought to play
an important role in genetic switches, where among other phenomena
this mechanism can explain the emergence of two alternative phenotypes
in clonal microbial populations, which can act to buffer the
population in a changing environment  [@Balaban2004].

<!--
**Further examples**
- @Read2007  Stochasticity generates an evolutionary instability for infectious disease 
- Spatial pattern formation: Turning patterns found in plankton-herbivore dynamics [@Levin1976]

-->

# Noise the informer: Noise can provide novel information


In examining "noise the creator," we began with a tension between
the intepretation of noise as it is usually presented in the context of
statistical inference: a nusiance to be stripped away, and how it is
viewed by theorist, as a potentially fundamental driver of patterns,
including oscillations, regime shifts, extinction & coexistence.
In this third section, we attempt to re-unite these two largely
divergent views of the role of noise by highlighting how phenomena
from the latter (noisy phenomena) can be used to address the questions
of the former (inferring underlying process from pattern). 

The most provacative example of how noisy phenomena can act to reveal
underlying processes comes from the literature on so-called 'early
warning signs' of critical transitions [e.g. @Scheffer2009].  This approach
exploits the ability of the equations we encountered in "origins of noise"
to reveal subtle changes in underlying processes before those changes are
visible at the macroscopic (deterministic) level.  This literature focuses
on the phenomenon of a tipping point, in which gradual changes to the environment
show essentially no changes to the behavior of a system (i.e. the abundance of a
population or health of lake ecosystem) followed by a rapid change when the
tipping point is reached that cannot be easily reversed. [@Scheffer2009;
@Scheffer2015].  The fundamental insight of early warning signals has been
to realize that though the average or deterministic dynamics of such a system
do not change significantly prior to the tipping point, the dynamics of the
noise must change in a consistent and predictable manner.

This pattern, known as 'critical slowing down' for reasons that will become 
obvious, was first proposed an an early warning sign for ecological
transitions by @Wissel1984, but has received considerable attention only more recently,
particularly owing to work in empirical systems [@Scheffer2015].
Our analysis in the origins of noise provides sufficient framework to illustrate
this idea completely.  The premise behind the tipping point just described
is that of a fold bifurucation [which I will not detail here, but see @Holling1973; @Scheffer2009; @Strogatz2001].
The key thing we need to know about this bifurcation is that it involves
changes *derivative* of the deterministic skeleton ($\partial_x \left[ b(x) - d(x) \right]_{x=\hat x}$) in
the notation of our example), which can build up for some time without
significant changes to the location of the equilibrium state $\hat x$.
This derivative did not appear in our marcroscopic equation, $\tfrac{\mathrm{d}x}{\mathrm{d}t} = b(x) - d(x)$,
but featured regularly in our equations for the noise, such as the 
expected variance, Eq \eqref{var} and autocorrelation, Eq \eqref{autocor}.
This derivative represents the *stability*  of the equilibrium: how quickly
deviations return to the stationary value.  
The magnitude of both variance and autocorrelation must increase
as the stability ($\partial_x \left[ b(x) - d(x) \right]_{x=\hat x}$) decreases
prior to a critical tranisition.  


The trick of the early warning signals approach is to view noise as 
a sequence of countless miniature perturbation experiments.

<!-- fixme need more background? --> 


<!-- Figure 4: Early warning signals -->
```{r tipping, fig.width=7, fig.height=10, fig.cap="Early warning signs of a critical transition in a simulation of increasing serial dilution of budding yeast. Panel A: Data from replicate manipulations by @Dai2015. Panel B: simulated single time series moel.  Panel C, D: Rolling variance and autocorrelation over simulated data show an increase in advance of the transition.  Simulation details in Appendix A. Warning signal statistics for experimental data not shown, see @Dai2015.\\label{tipping}"}
tipping <- read_csv("../appendixA/tipping.csv") 

pop_dai <- ggplot() + 
  annotation_raster(readPNG("figures/pop-dai2015.png"), 
                    xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf) +
  labs(subtitle = "A.")

pop_sim <- 
  tipping %>% 
  select(t, population = x, tip_time) %>%
  ggplot(aes(t, population)) + geom_line(col=colours[1]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[2], lty=2) + 
  scale_y_log10(labels=fancy_scientific)  + 
  coord_cartesian(ylim=c(1e3, 5e5)) +
  labs(subtitle = "B. Yeast population size", 
       caption = "Vertical red dashed line indicates tipping point location")

stat_sim <- tipping %>%
  dplyr::select(-x) %>%
  dplyr::rename("C. autocorrelation" = autocorrelation, "D. variance" = variance) %>%
  gather(series, value, -t, -tip_time) %>%
  ggplot(aes(t, value)) + geom_line(col=colours[[1]]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[[2]], lty=2) +
  facet_wrap(~series, ncol = 2, scales="free_y") 


gridExtra::grid.arrange(pop_dai, cv_dai, pop_sim, stat_sim,
                        layout_matrix = rbind(c(1,2), c(3,3), c(4,4)))

```


Increases in two of these early warning indicators,
variance and auto-correlation, are illustrated along with the
timeseries of a simulation of the dynamics of yeast population
growth in Figure \ref{tipping}.  This simulation is based on a mechanistic model
developed by @Dai2012 that closely matches the population dynamics
they observed in serial dilutions of budding yeast _Saccharomyces
cerevisiae_ on a sucrose medium. Because the relevant proteins are
located in the extra-cellular matrix rather than inside the cells,
budding yeast break down sucrose collaboratively, creating an Allee
effect below which the population is too small to sustain itself.
Increasing the serial dilution rate slowly over time drives the
stable population towards a fold bifurcation, which is accompanied
by the patterns of increasing variance and increasing auto-correlation
seen empirically in lab populations [@Dai2012] as well as the
numerical simulation shown in Figure \ref{tipping}.

As we saw in the equations from the system-size approximation, the
variance and auto-correlation in question are technically properties
of an ensemble, and should be computed over replicate simulations.
While the laboratory experiments of @Dai2012 do precisely this,
conducting identical, independent replicate manipulations in separate
beakers, this is not an option in natural populations.  If the
environmental change is sufficiently slow relative to the measurements,
one can assume that the system is close to its stationary state
over a given window in time, computing these averages over a rolling
time window as we illustrate here, rather than across an ensemble
of replicates.

The challenge of identifying warning signs that a system is approaching
a tipping point has proven a rich area for applications of stochastic
processes.  We have already seen how in addition to the patterns of
increasing variance and auto-correlation, our survey of stochastic phenomena
has highlighted the increased potential to observe stochastic switching,
or flickering, as the system approaches the tipping point.  Challenges remain
in distinguishing these patterns from other causes [@Boettiger2013a].
For instance, as we have seen, variance in a system can increase due to
external drivers without changing the auto-correlation, and both variance
and auto-correlation can increase if a system loses stability without
approaching a saddle-node bifurcation, but will not show flickering.
The greater our suite of stochastic indicators, the better our ability
to pin down the processes involved.  Such examples suggest
that stochastic processes could play a similar role in identifying
other critical transitions. For instance, stochastic resonance may be 
visible in advance of a Hopf bifurcation, where a stable state gives
way to stable oscillations (limit cycle) of growing magnitude
[e.g. @Fussmann2000; @Nelson2013; @Strogatz2001].

Most importantly, the framing of stochastic processes as indicators of
changes in an ecosystem that might otherwise go unnoticed has proven a
rich catalyst for bringing these concepts beyond the realm of abstract
theory. A rich array of experimental and observational tests of early
warning signals [_i.e._ @Carpenter2011; @Dai2012; @Clements2016; @Clements2017;
and many others, _e.g._ see @Scheffer2015 review] has served no merely
to illustrate these phenomena can be seen in laboratory and field ecosystems,
but also to spark suggestions of additional possible indicators and surface
a wide array of practical [@Boettiger2013b; @Scheffer2015], statistical
[e.g. @Boettiger2012d; @Boettiger2012], and theoretical [e.g. @Dai2015;
@Hastings2010] challenges to such application.  This creates a two-way dialog
between empirical and theoretical work that does much to advance the field
as a whole.


<!--
One of the most interesting aspects of noise is as a source of
additional information.  This can be realized in a variety of ways.
For instance, in deriving expressions for the variance created by
demographic noise above, we observed that different partitions of
a logistic growth model can lead to the same macroscopic dynamics
(same values for $b$ - $d$), while having different variance (due
to different values for $b$+$d$).  This suggests that the variation
observed in such a population could potentially help resolve
how dynamics are partitioned between individual birth and death
rates (though in practice one would have to first account for any
contribution of environmental noise).
-->



# Conclusions

The past two decades have seen widespread recognition of the central
role that stochasticity plays through the use of mechanistic models
can have in creating and understanding ecological phenomena
[@Coulson2004; @Black2012]. We have seen increasing use of
master-equation approaches to individual-based models to reflect
demographic stochasticity that is amenable to analytical treatment
[@Black2012], and much work in understanding the importance of
environmental noise, particularly the more realistic but less
mathematically convenient notion of colored or auto-correlated noise
on population dynamics, persistence, and coexistence [@Ovaskainen2010;
@Schreiber2017].  These deductive models can generate phenomena
that resemble familiar patterns such as population cycles for which
we have previously sought deterministic explanations, as well as
stochastic phenomena with no such analog such as stochastic switching.
Yet too many of these advances have remained limited to the domain
of theory; limited to deductive models which may seek to mimic
observed patterns but are rarely used to confront empirical data
directly.  There is good reason for this: statistical inference of
even relatively simple models with multiple sources of noise will
always be difficult given limited ecological data [@Knape2011].
However, many stochastic phenomena may suggest new ways to infer
rather than merely obscure underlying processes.


The eruption of interest in early warning signals for critical
transitions [@Scheffer2009] provides an excellent illustration of
this potential.  A range of stochastic phenomena have been suggested
and tested for their potential to reveal subtle signs of ecosystem
change prior to a dramatic shift, and prompted a rich dialog between
further theory and new experiment. Changes in stochastic properties
such as variance or auto-correlation provide evidence of resilience
loss that would be invisible to a deterministic model, and non-linear
stochastic phenomena such as stochastic switching are observed as
evidence of 'flickering' prior to a critical transition.  In this
way, our understanding of stochastic dynamics is translated into
novel sources of information about a system which has sparked a
wealth of empirical investigation and further theoretical work to
test the potential of this approach.  The study and application of
stochastic phenomena to detect ecosystem change is unlikely to be
limited to this simple scenario of a critical transition or fold
bifurcation.

Precisely because most stochastic phenomena arise through their
interaction with non-linearity, the patterns that result can become
a lens into better understanding those nonlinear processes and
detecting how they may change.  Meanwhile, the widespread adoption
of computational tools and the ability to express theoretical results
in numerical algorithms can make any new approaches more readily
accessible to application in empirical research. In the past two
decades, we have set to rest those deterministic skeletons that see
noise only as nuisance and embraced the central role noise plays
as the creator of ecological phenomena. Going forward, I hope and
predict that we will see greater discussion and use of stochastic
phenomena to infer underlying processes in empirical patterns in
similar interactions between theoretical and empirical research.



# References

