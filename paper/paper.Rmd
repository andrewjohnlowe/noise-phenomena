---
title: "From noise to knowledge: how randomness generates novel phenomena and reveals information"
author:
  - name: "Carl Boettiger"
    affiliation: a
    email: "cboettig@berkeley.edu"

address:
  - code: a
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"

csl: ecology-letters.csl
bibliography: refs.bib
output: rticles::elsevier_article  
layout:  review # review = doublespace, 3p = singlespace, 5p = two-column
preamble: |
  \newcommand{\ud}{\mathrm{d}}
  \linenumbers

#preamble: "\\usepackage[nomarkers]{endfloat}"

abstract: |
  I provide a brief synthesis of ecological research in stochastic phenomena. Noise, as the term itself suggests, is most often seen a nuisance to ecological insight, a inconvenient reality that must be acknowledged, a haystack that must be stripped away to reveal the processes of interest underneath. Yet despite this well-earned reputation, noise is often interesting in its own right: noise can induce novel phenomena that could not be understood from some underlying determinstic model alone.  Nor is all noise the same, and close examination of differences in in frequency, color or magnitude can reveal insights that would otherwise be inaccessible.  Yet with each aspect of stochasticity leading to some new or unexpected behavior, the time is right to move beyond the familiar refrain of "everything is important" [@Bjornstad2001].  Stochastic phenomena can suggest new ways of inferring process from pattern, and thus spark more dialog between theory and empirical perspectives that best advances the field as a whole. I highlight a few compelling examples, while observing that the study of stochastic phenomena are only beginning to make this translation into empirical inference.  There are rich opportunities at this interface in the years ahead.  
  


keywords:
  - stochasticity
  - demographic noise
  - environmental noise
  - colored noise
  - quasi-cycles

---

```{r libraries, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, dev="CairoPDF", fig.width=7, fig.height=3.5)
library(tidyverse)
library(gridExtra)
library(ggthemes)
colours <- ptol_pal()(2)
```

```{r suggested_libs}
library(hrbrthemes)
library(extrafont)

##extrafont::font_import(prompt=FALSE)    # One-time use to set up fonts, can be slow.
hrbrthemes::import_roboto_condensed()   # One-time use to set up fonts 
extrafont::loadfonts()
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())

#ggplot2::theme_set(theme_bw()) # simpler theme if you do not have these fonts
```


<!--
Directions:

We hope that these papers will combine a mix of synthetic reviews of the current state of an area, as well as insights into how the field has developed during the last twenty years, discussion of current important questions, and developments and insights that would significantly advance the field. Although certainly not necessary, if there are any past Ecology Letters papers that have had a profound impact on the development of an area – be it beneficial or not – a brief discussion of that impact would be appropriate. We also hope that articles will be written in a thoughtful style, but also provocative if appropriate.

-->


# Introduction: Noise the nuisance

Stochasticity is most often thought of as something which obscures
patterns we are trying to infer.  This is a simple consequence of
modeling: as discussed above, variables of interest to the processes
in question are modeled explicitly (e.g. change in population density
as it depends on the current density), everything else is just
noise.  Most statistical inference in ecology is built solely to
deal with this problem: pulling back the veil of noise to reveal
processes of interest.  Unfortunately, given the high levels of
variation and relatively limited data typical in ecological analyses,
this can be a significant challenge, and even as statistical and
computational advances provide more powerful and accessible inference
tools, the task only gets harder.  

For instance, few ecological
concepts are more central than the notion of density dependence:
that competition in some form or other should limit a species ability
to grow without bound.  Yet establishing statistical evidence for
density dependence is remarkably difficult, as illustrated by
@Knape2011.  Using time series from the Global Population Dynamics
Database (GPDD) Knape & de Valpine show that once one accounts for
the potential for measurement error in addition to environmental
stochasticity -- an unavoidable source of noise in most ecological
data -- it becomes difficult to find evidence for even the simplest
models of density dependence in the majority of available time
series.  Faced with such uncertainty, it is tempting to throw up
our hands and wait until some prophesied deluge of streaming
micro-sensors stapled to every organism provide enough signal to
beat back the noise. Fortunately, this has not been the path taken.

<!-- okay, claiming this for the last 2 decades might be overly provocative?-->
Over the past twenty years, ecological theory, modelling, and methods
have increasingly elucidated the role of noise not only to *obscure*
patterns but to *create* them.  This period marked a transition
away from the intense focus on simple models which exhibited
deterministic chaos that had enchanted much of theoretical ecology
in the previous two decades [@Bjornstad2001] in favor of more complex
and stochastic models.  Of particular interest has been those
conceptual advances that have bridged the divide from theoretical
to empirical interest -- not merely the introduction of "real data"
in a theoretical paper, but rather the concepts that take on a life
of their own in the larger research community.  Consequently, this
paper seeks to be a bridge between two audiences: theoretical
researchers already expert in noisy phenomena but in interested in
reaching wider empirical application, and also primarily empirical
researchers seeking an entrance into noisy phenomena.

<!-- Regarding simulation examples -->
In this spirit, each of the examples illustrated here is coupled
with concise and efficient R code in the appendix to both reproduce
and further explore the simulations.  While examples of noisy
phenomena in natural systems are also crucial, matching the pattern
does not necessarily mean we have also matched the process behind
the data.  The examples cited from the literature here offer some
of the best empirical evidence of these phenomena, but I encourage
readers to also experiment with the example code provided.  Simulations
permit poking and prodding of empirical investigation quickly and
with little mathematical formalism in the way.  In the code provided,
most stochastic models are expressed in the BUGS language, which
may be more familiar to empirical readers than corresponding
mathematical formulas. This also permits both efficient simulation
and potential estimation of parameters given sample data using the
R package, NIMBLE [@DeValpine2017]; allowing the deductive models
illustrated here to readily function as inductive models with
parameters inferred from time-series data. A copy of this appendix
is maintained at <https://github.com/cboettig/noise-phenomena>, and
bug reports, suggestions or help requests are welcome through the
issue tracker.  A second appendix provides more mathematical details
for interested readers.  With these in place, we are ready to begin
our tour through three major areas of noisy phenomena: Origins of
noise, emergent phenomena, and noise-driven inference.

<!-- MAP -->
Our first stop will be into research into the origins of noise.
This will not only let us set up definitions for terms and concepts
we will encounter throughout, but also introduce some of the
fundamental mathematical and computational tooling needed in our
tour of noisy phenomena.  From origins of noise, we will then explore
some of the phenomena that noise can create.  These examples are
central to the conceptual transition away from viewing noise only
as a nuisance that obscures patterns and realize the rich set of
patterns and phenomena that can emerge.  Our tour will be by no
means exhaustive, but as with chaos before it, theoretical allure
does not always reflect ecological relevance.  Having looked at
some of the phenomena that can be created by noise, our third stop
will try to run this in reverse: using noise to infer underlying
phenomena.  Examples here are rarer but potentially the most
rewarding, bridging the gap from theoretical construct to empirical
investigation.  The most compelling examples have come from ways
in which noisy phenomena are used to infer stability and forecast
changes in resilience of populations or ecosystems. Though not
without weaknesses or missteps, the resulting dialog between
theoretical and empirical aspects have made this particularly a
rich area of research.  We end our tour by considering what features
best enable the translation and ecological relevance of noisy
phenomena.


# Origins of noise


What is noise? Where does it come from?  It is important to bear
in mind that whenever stochasticity is introduced into a model, it
is only as a simplification or summary of the effects of a large
number of other processes, often occurring at different scales.
Simply put, *noise is all that we leave out of our model*.  Early
quantitative ecological models first formulated at the population
level as differential or difference equations: deterministic models
that seek to capture the essential features of a system while
neglecting any random component as mere noise [@Coulson2004].
Advances in both theoretical understanding and the advent of widely
available and efficient numerical methods have helped drive research
towards increasingly more explicit descriptions of how stochasticity
enters into quantitative models [@Black2012; @Ovaskainen2010].

With the exception of quantum mechanics (and there only at scales
that have no relevance to ecology), stochasticity is not an inherent
property of nature but rather an emergent property of many events
occurring at a different scale.  Coins and dice obey the physical
laws of motion; only variation in how they are tossed (i.e. something
complex we do not usually model) creates randomness.  The term
"noise" itself reflects this emergent rather than fundamental origin:
the combination of hundreds of voices and sounds each individually
distinct blends together into a background of noise. Statistical
mechanics tells us that temperature is a measure of the average
speed of individual molecules in a gas -- any given molecule will
experience a range of possible speeds but by itself has no notion
of temperature.  Likewise, stochasticity enters our ecological
models because our quantities of interest, such as the density of
a population, is but an average over a lower-level, discrete process
of individual births and deaths. Stochasticity that emerges directly
from discrete individual events that underlie the process described
by our model are considered *intrinsic stochasticity*, commonly
referred to as *demographic stochasticity* in ecological literature,
as it usually arises in the context scaling from individual demographic
events to population level descriptions. An important aspect of
this demographic stochasicity is that it scales with the square
root of the "system size," so that for very large populations the
resulting fluctuations are relatively small. On the other hand,
*extrinsic stochasticity*, usually referred to as *environmental
stochasticity* in the ecological literature, arises in processes
that are not described by our model, but merely impact the value
of some parameter of our model; for instance, fluctuations in
temperature may drive variation in a death rate, or fluctuations
in rainfall drive variation in carrying capacity.


## Demographic stochasticity

Demographic stochasticity refers to fluctuations in population sizes
or densities that arise from the fundamentally discrete nature of
individual birth and death events.  Demographic stochasticity is a
particularly instructive case for illustrating a mechanism for how
noise arises as an aggregate description from a lower-level mechanistic
process.  We summarize the myriad lower-level processes that
mechanistically lead to the event of a 'birth' in the population
as a probability: in a population of $N$ identical individuals at
time $t$, a birth occurs with probability $b_t(N_t)$ (_i.e._ a rate
that can depend on both the population size $N$) and increases the
population size, $N$ to $N+1$, and deaths occur with probability
$d_t(N_t)$, decreasing the population size, $N$ to $N-1$.  Assuming
each of these events are independent, this is a state-dependent
Poisson process. The change in the probability of being in state
$N$ is given by the sum over the ways to enter the state, minus the
ways to leave the state: a simple expression of probability balance
known as the "master equation."

It is possible to simulate such a process exactly using Gillespie's
exact stochastic simulation algorithm [SSA; @Gillespie1977], which
simulates each individual birth or death as a separate event. Figure 1
uses this algorithm to compare simulations of the Levins' patch model;
see Appendix A for example code.  In the Levins'  model,
$n$ individuals compete for a
finite number of suitable habitats $N$.  Individuals die a constant
rate $e$, and produce offspring at a constant rate $c$ who then
have a probability of colonizing an open patch that is simply
proportional to the fraction of available patches, $1 - n/N$.  

\begin{align}
\frac{\ud n}{\ud t} = \underbrace{c n \left(1 - \frac{n}{N}\right)}_{\textrm{birth}} - \underbrace{e n}_{\textrm{death}}, \label{levins}
\end{align}

Figure 1 shows the results of two exact SSA simulations of this model with
identical parameters except for the total number of available sites,
$N$.

<!-- Figure 1: Gillespie simulations -->
```{r gillespie, warning=FALSE, fig.width=7, fig.cap="Population dynamics from a Gillespie simulation of the Levins model with large (N=1000, panel A) and small (N=100, panel B) number of sites (blue) show relatively weaker effects of demographic noise in the bigger system. Models are otherwise identical, with e = 0.2 and c = 1 (code in appendix A). Theoretical predictions for mean and plus/minus one standard deviation shown in horizontal re dashed lines."}
read_csv("../appendixA/gillespie.csv", col_types = "cdiddd")  %>% 
  mutate(system_size = recode(system_size, large = "A. 1000 total sites", small= "B. 100 total sites")) %>%
  ggplot(aes(x = time)) + 
  geom_hline(aes(yintercept = mean), lty=2, col=colours[2]) + 
  geom_hline(aes(yintercept = minus_sd), lty=2, col=colours[2]) + 
  geom_hline(aes(yintercept = plus_sd), lty=2, col=colours[2]) + 
  geom_line(aes(y = n), col=colours[1]) +
  facet_wrap(~system_size, scales = "free_y") 
```


The van Kampen system size expansion provides a convenient way to
explicitly approximate the "macroscopic" (i.e. population level,
see @Black2012) dynamics from an individual-based description of
events in a Markov process [@vanKampen2007; based on @Kurtz1970;
@Kurtz1971].  In addition to illustrating how common stochastic
models (in particular, Gaussian noise) arise from lower-level
descriptions, this result will also provide us a useful framework
for interpreting the behavior of stochastic models more generally.
In Appendix B I illustrate the derivation of the following equations
for the mean and expected population sizes for a generic density
dependent birth-death process:

\begin{align}
\frac{\mathrm{d} x }{dt}  &= b(x) - d(x) + O(N^{-1})\\
\frac{\mathrm{d} \sigma^2 }{dt}  &= 2 \left( \partial_x b(x)  - \partial_x d(x) \right) \sigma^2 + b(x) + d(x) \label{bd}
\end{align}

where $x = \langle n \rangle$, the average or expected population
size of an ensemble of replicates, assuming the transitions (+/- 1
in this case) are much smaller than the system size ($N$ in the
Levins model).  The dynamics for the average population
match the population-level equation.^[up to fluctuations of order
$\tfrac{1}{N}$. We can actually both observe and successfully
approximate this higher-order correction from additional terms in
the system size expansion to recover the phenomenon of stochastic
inflation [@Gonzalez2002], where the average population size can
be larger or smaller than predicted by the deterministic model --
see Appendix A for examples in simulations compared to predictions
of the system size expansion].

The change in variance can be seen
as a balance between the stochastic contribution, $b(x) + d(x)$
and the deterministic contribution, $\partial_x \left(b(x) - d(x)\right)$. 
The deterministic contribution is the slope of the macroscopic
equation, that is, the eigenvalue indicating the stability of the
equilibrium point.  For stable points, this value must be negative
and precisely balance the strictly positive stochastic contribution 
of $b(x) + d(x)$ (the greater the rate of stochastic events involved, 
the greater the fluctuations).  This balance at steady-state is known as the
fluctuation-dissipation theorem [@vanKampen2007], an will prove a useful
expression in understanding stochastic dynamics.  Because Eq \eqref{bd}
also describes the time-evolution of these fluctuations, we can similarly
solve for the correlation between two points separated by time $\tau$.

For our Levins' model, $b(n) = n (1 - \tfrac{n}{N})$ and $d(n) = en$,
we find the average number of occupied patches 
$\langle n \rangle = N\tfrac{e}{c}$ with variance at steady-state of 
$\sigma^2_n = N \tfrac{e}{c}$.  Observe that the variance scales proportionally
to the system size, $N$, which explains the standard deviation
increases only as $\sqrt{N}$ while the steady state itself increases
in direct proportion to $N$, resulting in the smaller relative size
of fluctuations in the larger system in Figure 1.  We can also see
that different ways of partitioning the same macroscopic equation
into components of birth and death will create the same mean dynamics
but with different levels of noise.  For instance, in a logistic
model with $b = rn$ and $d = rn^2/N$, we instead find the variance
at steady state is $\sigma^2 = K$; significantly larger than in the
Levins model.


## Environmental stochasticity

Whereas demographic noise reflects processes at a lower scale (the
individual, rather than the population), environmental stochasticity
reflects processes whose dynamics we are not explicitly modelling.
Once again, this can best be illustrated through an explicit
formulation of the master equation.  For a generic population model
that depends not only on population state $x$ but also on environmental
factors $y$, it is possible to derive the steady-state variance
(Appendix B) as:

\begin{equation}
\sigma_x^2  = \frac{ \left( \partial_y f(x,y) \right)^2}{\left( \partial_x f(x,y) \right)^2 + \partial_x f(x,y) \tau_c } \sigma_e^2 + \sigma^2_d \label{env_noise}
\end{equation}

where $\sigma_e^2$ is the variance in the environmental noise and
$\tau_c$ the auto-correlation of that noise, $\sigma_d^2$ the
equilibrium variance contributed by demographic noise from before,
($\tfrac{b + d}{-2\partial_x (b - d)}$) and where we have defined
$f(x,y) = b(x,y) - d(x,y)$ for notational convenience.  For example,
if extinction rate $e$ in our Levins' model is allowed to vary
stochastically as Gaussian white noise with variance $\sigma_e^2$
and mean $e$, we find the expected variance introduced in the
population to be:

$$\sigma_n^2 = \frac{e^2}{(c+e)^2} \sigma_e^2 + \frac{e}{c}N $$

Note that the contribution of environmental stochasticity is
independent of system size and directly proportional to the variance
in the environment.  This derivation provides a useful illustration
of the difference between demographic noise and environmental noise:
the latter simply describes the variation introduced by some other
dynamic variable that we are not modelling explicitly, and whose
dynamics are independent of the state of our system, $x$. This
environmental variation no doubt also arise from some more detailed
lower level process, but we need not be explicit about those dynamics
-- the expansion tells us that it is sufficient to know the overall
variance and the degree of auto-correlation.  Recent work has also
highlighted the importance of including both demographic and
environmental noise [@Melbourne2008; @Bonsall2004].  The system
size expansion still requires the assumption that the noise is small
relative to the system size.  In the case of large fluctuations,
this approximation must be replaced with a different approach, such
as the WKB approximation, as discussed in @Ovaskainen2010.

The importance of $\tau_c$, or the degree of auto-correlation, which
emerges from our derivation above, has also been and continues to be a subject of
significant interest in the study of stochastic population dynamics
[e.g.@Roughgarden; @Ellner; @Lawton; @Ripa1999; @Marshall2015].
Early work rarely often assumed environmental noise would be
uncorrelated as a mathematical convenience.  As the derivation of
Eq \eqref{env_noise} makes clear, for a continuous-time process,
the relevant metric is the timescale of auto-correlation in the
environmental noise process relative to the auto-correlation timescale
of the population dynamics.  The Gaussian noise that emerges out
of the system-size approximation is always auto-correlated to some
degree -- if we measure our environment at consecutive times
infinitesimally far apart, we expect nearly identical values.  At
intervals much longer than the correlation time, consecutive
measurements are effectively independent (i.e. white noise). 
The degree of auto-correlation in  noise is all about _relative_ timescales.


## Other forms of stochasticity

Stochasticity frequently enters our models in other ways as well.
For instance, most population-level models treat all individuals
within the population, or at least within a particular age or stage
class, as identical.  *Individual heterogeneity* in relevant traits
(growth rates, dispersal ability) can be represented probabilistically
as a distribution rather than a fixed value, making it function as
another form of random variation in a model [@Coulson2001;
@Schreiber2010].  *Spatial heterogeneity* can likewise be reflected
in stochastic parameters of a spatially implicit model, or as
spatially varying environmental stochasticity in a spatially explicit
model.  As with other forms of noise [@Melbourne2008; @Bonsall2004],
interaction between individual or spatial variation and other sources
of noise can drive patterns including the potential for persistence,
coexistence, and dispersal of species [@Schreiber2010; @Hart2016;
@Schreiber2017].  *Observational error* acts
much like another form of stochasticity, arising from sampling
effects or limitations of instruments, etc. Yet unlike the sources
described above, this uncertainty does not impact the actual state
of our system, and thus does not give rise to any additional phenomena
or information about that process, though it can obscure it
[@Knape2011; @deValpine2002].

Other forms of uncertainty common in models are not stochastic
phenomena.  This includes any form of *reducible uncertainty*: In
constructing and estimating mathematical models of ecological
processes, we encounter uncertainty over our parameter estimates
and possible choice of models [@Ellison2004].  In some ways, this
uncertainty can act like the stochasticity described above: for
instance, both introduce variation into any forecast of future
outcomes. Yet unlike stochasticity, this uncertainty is reducible:
with additional observations, we can narrow the uncertainty over
parameters or candidate models, while stochasticity remains an
inherent source of variation. We will this not consider model and
parameter uncertainty, as they are not sources of noise.  *Deterministic
chaos* [@Desharnais2001] is another mechanism of introducing
significant variation into a simple model. Chaos can a look a lot
like noise: indeed, it can be observationally indistinguishable
from a stochastic process [@Ellner2005; @Werndl2009].  Despite
substantial interest in previous decades and the relative ease of
encountering chaos in simple ecological models (particularly in
differences equations), and convincing reconstructions of chaotic
dynamics in laboratory manipulations [@Costantino1997] the prevalence
of chaotic dynamics as a driving factor in most ecological systems
remains unclear. After all, the great variation of natural populations
is hardly surprising: the undeniable influences of variation created
by all those things left out of our models, all that individual
detail from intrinsic, lower level processes and external environmental
processes that becomes aggregated in our simple models all but begs
for a stochastic description.

Much active research continues to explore the consequences of
introducing these more explicitly motivated and interacting sources
of noise. With some grounding in the origins of different types of
noise in place, we are ready to move to our second stop to see how
this noise can drive the creation of novel phenomena on a macroscopic
level.



# Noise the creator: Noise can induce novel phenomena

Stochasticity can give rise to a wide array of interesting phenomena
that are often at odds with our intuition. As these examples will
illustrate, such behavior arises through an interaction between
stochastic and non-linear elements of a system, underscoring the
importance of explicitly including stochasticity in ecological
models [@Coulson2004; @Higgins1997].  Importantly, the noise itself
does not have to be large to give rise to these phenomena.  In this
section, I highlight several examples that have shown up frequently
in the literature and prove sufficiently tractable to provide a
simple intuition for the mechanisms involved.

## Persistence and coexistence  

A natural focus of much research into stochastic ecological systems
has been on understanding the implications for persistence of
individual and coexistence of interacting species. Demographic noise
in particular has fundamental implications for the long-term
equilibrium: any finite population, however big, is guaranteed to
eventually go extinct under demographic noise.  However, in most
models it is possible to define a notion of quasi-stationary 
distribution concentrated around the deterministic attractor,
and to prove the probability of extinction decreases exponentially with 
system size (e.g. see @Ovaskainen2010; @Schreiber2017 also reviews 
more recent literature which has established these results more generally). 
Generalizations about persistence and stable coexistence of interacting
species in stochastic models are difficult due to complex interactions
between demographic and environmental noise, population structure,
spatial heterogeneity, magnitude of noise, degree of auto-correlation and so forth
[e.g. @Higgins1997; @Coulson2001; @Melbourne2008; @Hart2016];
indeed care must be taken even in defining the appropriate notion of 
persistence [e.g. @Schreiber2006].  Instead of these long-term limits,
here we will focus on a few examples of stochastic phenomena 
that can emerge on shorter time scales and provide some intuition for 
how the interaction between stochastic an nonlinear dynamics can 
create these surprising results.  

<!--

Insufficient space left for any treatment of these...
Permenance, robust permenance

**Bet hedging**, Lewontin & Cohen 1969; Levins 1969; 

-->


<!-- Figure 2: Quasi-cycles -->
```{r quasicycles, fig.width=7, fig.cap="Panel A: under negligible environmental noise, the introduction of a carrying capacity damps Lotka-Volterra oscillations which eventually settle to a stable state.  Panel B: small noise induces quasi-cycles in the same model: sustained long-term oscillations predominately around the natural frequency of the original damped oscillations. Parameters for models shown are r = .1, K = 5,  b = .1, c = .1, d = .1, N = 800; code in Appendix A."}
read_csv("../appendixA/quasicycles.csv") %>%
  gather(species, population, -t, -sigma) %>%
  mutate(sigma = as.factor(sigma)) %>%
  mutate(sigma = recode(sigma, "1e-05" = "A.", "0.01" = "B.")) %>%
  rename(time = t) %>%
  ggplot(aes(time, population, col = species)) + geom_line() + 
  facet_wrap(~ sigma, ncol=2) + scale_color_ptol() 
```


## Quasi-cycles 

Understanding the origin of sustained oscillations has long been a
central question in ecology [@Hastings1996; @Bjornstad2001].  The
simple Lotka Volterra model produces only neutrally stable centers,
while the more realistic model that introduces carrying capacity
for prey as they compete for resources results in a model that
produces only damped oscillations, eventually settling into a stable
state (Figure 1A).  However, the introduction of relatively small
noise into the system can be sufficient to excite the system into
sustained oscillations (Figure 1B).  In the example shown here, a
simple predator-prey system is driven by environmental white noise
$\xi_t$, with prey following the equation:

$$x_{t+1} = x_t + x_t r \left(1 - \frac{x_t}{K}\right) - b x_t  y_t + \xi_{x,t}$$
where $x_t$ is the prey density at time $t$, $r$ the growth rate, $K$ the carrying capacity, $b$ an encounter rate with the predator $y$, who obeys the equation:

$$y_{t+1} = y_t + c  x_t  y_t - d  y_t+ \xi_{y,t} $$
with $c$ the conversion ratio and $d$ the predator mortality rate.  Here we have assumed for the prey, $\xi_x \sim \mathcal{N(0, \sigma_x)}$, and similarly for the predator driven by $\xi_y$. Figure 1A shows examples for noise $\sigma_x = \sigma_y = 10^{-5}$, while Figure 1B shows $\sigma_x = \sigma_y = 0.01$.  



Oscillations arise through the process of stochastic resonance.
The damped oscillations seen in Figure 1a are analgous to a child
sitting still on a swing: friction slowly damps the magnitude of
each successive oscillation, while the period of pendulum remains
unchanged.  Driving the pendulum through perturbations timed to
match that natural period can quickly create sustained oscillations
with large magnitudes, but such perfect timing is not required.  In
the model above, white noise effectively drives the pendulum at all
frequencies, though at very low magnitude, since the noise is small
relative to the scale of the dynamics.  However, frequencies that
most closely match the natural period of the damped oscillator are
amplified, resonating with the natural oscillations.  This process
is sufficient to permit even small noise to drive sustained
oscillations in the model indefinitely.  The power spectrum (the
squared norm of the Fourier transform, a measure of what frequencies
are present; see, e.g. @Black2012) provides a convenient way to
visualize the effects of these oscillations.  The power spectrum
for a deterministic limit cycle would create a perfect sinusoidal
oscillation and a resulting power spectrum of a delta spike at that
single frequency.  The power spectrum for the quasi-cycle instead
shows a distribution of frequencies, centered at the the resonant
frequency of the damped oscillator.

Early work by @Blarer1999 identified quasi-cycles as a possible
explanation for oscillations and periodic outbreaks in pest ecosystems.
@Bjornstad2004 analyzes the potential for such stochastic effects
to drive cyclic behavior in population abundances of Atlantic bluefin
tuna and Atlantic Cod, while @Black2010 illustrates the use of
power-spectrum approaches to examine the behavior of quasi-cycles
in common disease outbreak models, focusing on a case where noise
arises explicitly from demographic stochasticity, rather than generic
environmental noise as in the model above and elsewhere.  @Pineda-Krch2007
compare patterns from these stochastically generated cycles to
stable limit cycles they resemble.  Stochastic resonance highlights
one way in which even small noise can play an important role in
driving large scale patterns where we had previously only sought
deterministic explanations. This example also illustrates the
interplay between nonlinear dynamics and stochasticity that is the
hallmark of stochastically driven phenomena.  A stable node with
linear dynamics, such as an Ornstein-Uhlenbeck process, has no
resonant frequency, and could not produce sustained oscillations
(unless the environmental driver itself had a periodic pattern).

<!-- See additional citations in Coulson2004 and others that mention stochastic resonance --> 


## Stochastic switching

We turn from stochastic resonance to oscillations of a very different
sort, which do not resemble any deterministic process, as seen in
Figure 3A.  This pattern is characterized by long stretches during
which fluctuations in the state variable remain concentrated around
a high average value followed by sudden, rapid transitions into
fluctuations concentrated around a lower value.  This behavior
arises through the interaction of stochasticity and alternative
stable state dynamics.  The simulation shown in Figure 3A for the
is based on an resource consumption model first proposed by @May1977
as one of the early examples of the potential for alternative stable
state dynamics.  The resource grows according to a logistic growth
model and is consumed according to a Holling Type-III functional
response curve, to which I have simply introduced the addition of
environmental noise:

$$X_{t+1} = X_t + \underbrace{X_t r \left(1 -\frac{X_t}{K} \right)}_{\textrm{ growth, } g(X_t)}  - \underbrace{\frac{a X_t ^ Q}{X_t^ Q + H ^ Q}}_{\textrm{consumption, } c(X_t)} + \xi_t,$$

where $\xi_t$ is normally distributed environmental variation with
mean zero and standard deviation $\sigma$. Figure 3B shows separate
curves corresponding the parts of the model describing vegetation
growth and vegetation consumption, using the same parameters as
shown in the simulation panel, 3A.  Equilibria exist whenever growth
balances consumption.  For the parameters shown, the S-shaped curve
of the Type-III consumption pattern crosses the quadratic curve of
logistic growth at four separate locations.  When growth is larger
than consumption before the crossing, and thus smaller after, the
point is stable, otherwise it is unstable.  Consequently, we can
see two stable points, in the neighborhood of $X_t \approx 1.2$ and
$X_t \approx 0.5$, closely matching the average fluctuations seen
in the simulation in 3A.  Stochastic fluctuations drive spontaneous
shifts between these alternative stable states.

The concept of a potential well, Figure 3C, is often invoked when
describing the behavior of alternative stable states.  The curve
for the potential well, $U(x)$ is defined as the negative integral
of the population growth rate,

$$U(x) = -\int_0^x f(y) \textrm{d} y $$ 

where in our model $f(y)$ is vegetation growth minus consumption,
$f(y) = g(y) - c(y)$.  The motivation comes from physics, where $f$
is a force and $U$ the corresponding potential energy.  This suggests
a convenient analogy to gravity, often implied by drawing a ball
inside the curve and referring to this as a "ball-in-cup" diagram.
The potential function is particularly instructive for understanding
stochastic switching under small noise, as in our simulation in
Figure 3, where it is straight-forward to show [e.g. @Feller;
@vanKampen2007] that the probability of a transition is proportional
the exponential of the depth of the well from the lowest point to
the separation barrier, (a result that is familiar as Arrhenius law
of activation energy to grade-school students of chemistry).  This
is effect is visible even in the short simulation shown in 3A, which
spends longer times in the lower state which has the deeper well.
(Readers are encouraged to experiment with this by adjusting the
parameters of the simulation in the included code).  Unfortunately,
the literature is not always careful in describing how this potential
well diagram arises, which has caused it to become a source for as
least as much confusion as it is of insight.  While the curves in
Figure 3B can be clearly associated with underlying mechanisms of
rates: logistic growth and consumption with handling time, the same
is not true of the potential: it is much harder to have a good
intuition about the 'negative integral of the difference growth and
consumption,' and how it would change in response to, say, a larger
carrying capacity $K$ or higher consumption rate $a$.  While the
x-axis of the potential diagram remains the same: the system state,
the conceptual problem is clearly evident in the usual ambiguity
describing the y-axis in such ball-in-cup models.


<!--Figure 3: Noisy switch -->
```{r noisy_switch, fig.width=7, fig.height=7, fig.cap="Stochastic switiching in May's model of alternative stable state dynamics.  r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 10000"}

p <- list(r = .5, K = 2, Q = 5, H = .38, sigma = .04, a = 0.245, N = 1e4)

theory <- 
  tibble(x= seq(0,2, length.out = 100)) %>%
  mutate(g = x * p$r * (1 - x / p$K), 
         c = p$a * x ^ p$Q / (x^p$Q + p$H^p$Q)) %>%
  mutate(potential = - cumsum(g - c)) %>%
  gather(curve, y, -x, -potential) 


p1 <- read_csv("../appendixA/noisy_switch.csv")  %>%
  ggplot(aes(t,x)) + 
  geom_line(lwd=.1, col=colours[[1]]) +
  labs(subtitle = bquote(bold(A.)))

p2 <-  theory %>%
  ggplot(aes(x, y, col=curve)) +
  geom_line(lwd=1) + 
  scale_color_ptol() + 
  labs(x = bquote(X[t]), y = bquote(X[t+1]), subtitle= bquote(bold(B.))) +
  theme(legend.position="top")

p3 <-  theory %>%
  ggplot(aes(x, potential)) + 
  geom_line(col=colours[1], lwd=1) + 
  coord_cartesian(xlim=c(0,1.6), ylim=c(-1.15,-0.9)) + 
  labs(subtitle = bquote(bold(C.)))


gridExtra::grid.arrange(p1,p2,p3, layout_matrix = rbind(c(1,1), c(2,3)))
```


Despite the nearly ubiquitous association of a ball-in-cup model
with ecological discussions of resilience and stability, this
potential well diagram (Figure 3C) is also a source of confusion
on the topic.  As we have seen, the most salient feature of this
diagram is the depth of each well: transition probabilities (under
small noise) depend only on the depth of the well and not the
steepness of the well, the distance between the wells or between
well and tipping point barrier.  However, it is important to remember
that because the potential function is defined by the above integral,
it in fact already combines two more elementary and mechanistically
precise quantities from the growth equation: the slope of the growth
rate (stability) and the distance to the tipping point (size of the
basin of attraction).  Both a steeper negative slope or a longer
distance to integrate over between stable and unstable points will
create a deeper well.

Empirical evidence for stochastic switching in ecological timeseries
is limited by the long time scale usually required. Because a single
stochastic transition between alternative stable states appears as
such a dramatic deviation from the previous pattern (as illustrated
in Figure 3A), it is often tempting to assume the change could only
be the result of some sudden external force or change in the
environment, so it is worth remembering that given long enough,
these transitions can happen entirely by chance stochasticity
[@Boettiger2012; @Drake2013]. However, these transitions are most
likely to observed in systems with relatively shallow potential
wells.  This is mostly likely to occur of some external change is
slowly making the potential well shallower and thus transitions
more likely -- a phenomenon that has become to be known as "flickering"
and suggested as a potential early warning sign of an approaching
transition [@Brock2010].  Examples of flickering between alternative
stable states have been suggested in data ranging from geological
timescales at the end of glaciation in the Pleistocene [@Taylor1993]
to ecological scales over a few decades in lake ecosystems [@Wang2012].
Stochastic transitions between bi-stable states are thought to play
an important role in genetic switches, where among other phenomena
this mechanism can explain the emergence of two alternative phenotypes
in clonal microbial populations, which can act to buffer the
population in a changing environment  [@Balaban2004].

<!--
**Further examples**
- @Read2007  Stochasticity generates an evolutionary instability for infectious disease 
- Spatial pattern formation: Turning patterns found in plankton-herbivore dynamics [@Levin1976]

-->

# Noise the informer: Noise can provide novel information

One of the most interesting aspects of noise is as a source of
additional information.  This can be realized in a variety of ways.
For instance, in deriving expressions for the variance created by
demographic noise above, we observed that different partitions of
a logistic growth model can lead to the same macroscopic dynamics
(same values for $b$ - $d$), while having different variance (due
to different values for $b$+$d$).  This suggests that the variation
observed in such a population could resolve potentially help resolve
how dynamics are partitioned between individual birth and death
rates (though in practice one would have to first account for any
contribution of environmental noise).

<!-- fixme need more background? --> 


<!-- Figure 4: Early warning signals -->
```{r tipping, fig.width=7, fig.height=7, fig.cap="Early warning signs of a critical transition in a simulation of increasing serial dilution of budding yeast.  Panel A: Rolling variance   autocorrelation Time series is shown in panel C. Model details and simulation parameters in Appendix A."}
tipping <- read_csv("../appendixA/tipping.csv") 

p1 <- tipping %>%
  select(-x) %>%
  rename("A. autocorrelation" = autocorrelation, "B. variance" = variance) %>%
  gather(series, value, -t, -tip_time) %>%
  ggplot(aes(t, value)) + geom_line(col=colours[[1]]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[[2]], lty=2) +
  facet_wrap(~series, ncol = 2, scales="free_y")  
p2 <- tipping %>% 
  select(t, population = x, tip_time) %>%
  ggplot(aes(t, population)) + geom_line(col=colours[1]) + 
  geom_vline(aes(xintercept = tip_time), col=colours[2], lty=2) + 
  #scale_y_log10()  + 
  labs(subtitle = "C. Yeast population size", 
       caption = "Vertical red dashed line indicates tipping point location")

gridExtra::grid.arrange(p1,p2, layout_matrix = rbind(c(1,1), c(2,2)))

```



Noise can provide novel information in other ways as well.  Stochastic
fluctuations act like a continual miniature perturbation experiment,
constantly pushing a system away from an equilibrium to reveal its
behavior elsewhere in state space. Observing the size and
auto-correlation of these fluctuations thus provides insight on the
stability of an equilibrium point, (as can be seen, for instance
in the fluctuation-dissipation result we found for generic birth
death models).  This observation has been exploited with particular
success as a potential *early warning sign* that a system is loosing
stability; possibly due to an approaching catastrophic transition
or saddle-node bifurcation.  This pattern, known as critical slowing
down (in reference to the auto-correlation time in the physics
literature) was first proposed an an early warning sign for ecological
systems by @Wissel1984, but has received considerable empirical as
well as theoretical attention only more recently [@Scheffer2009;
@Scheffer2015].  Increases in two of these early warning indicators,
variance and auto-correlation, are illustrated along with the
timeseries of a simulation of the dynamics of yeast population
growth in Figure 4.  This simulation is based on a mechanistic model
developed by @Dai2012 that closely matches the population dynamics
they observed in serial dilutions of budding yeast _Saccharomyces
cerevisiae_ on a sucrose medium. Because the relevant proteins are
located in the extra-cellular matrix rather than inside the cells,
budding yeast break down sucrose collaboratively, creating an Allee
effect below which the population is too small to sustain itself.
Increasing the serial dilution rate slowly over time drives the
stable population towards a fold bifurcation, which is accompanied
by the patterns of increasing variance and increasing auto-correlation
seen empirically in lab populations [@Dai2012] as well as the
numerical simulation shown in Figure 4.

As we saw in the equations from the system-size approximation, the
variance and auto-correlation in question are technically properties
of an ensemble, and should be computed over replicate simulations.
While the laboratory experiments of @Dai2012 do precisely this,
conducting identical, independent replicate manipulations in separate
beakers, this is not an option in natural populations.  If the
environmental change is sufficiently slow relative to the measurements,
one can assume that the system is close to its stationary state
over a given window in time, computing these averages over a rolling
time window as we illustrate here, rather than across an ensemble
of replicates.

The challenge of identifying warning signs that a system is approaching
a tipping point has proven a rich area for applications of stochastic
processes.  We have already seen how in addition to the patterns of
increasing variance and auto-correlation, our survey of stochastic phenomena
has highlighted the increased potential to observe stochastic switching,
or flickering, as the system approaches the tipping point.  Challenges remain
in distinguishing these patterns from other causes [@Boettiger2013a].
For instance, as we have seen, variance in a system can increase due to
external drivers without changing the auto-correlation, and both variance
and auto-correlation can increase if a system loses stability without
approaching a saddle-node bifurcation, but will not show flickering.
The greater our suite of stochastic indicators, the better our ability
to pin down the processes involved.  Such examples suggest
that stochastic processes could play a similar role in identifying
other critical transitions. For instance, stochastic resonance may be 
visible in advance of a Hopf bifurcation, in which a stable node becomes
a limit cycle.

Most importantly, the framing of stochastic processes as indicators of 
changes in an ecosystem that might otherwise go unnoticed has proven a
rich catalyst for bringing these concepts beyond the realm of abstract
theory. A rich array of experimental and observational tests of early
warning signals [_i.e._ @Carpenter2011; @Dai2012; and many others, _e.g._ see @Scheffer2015 review] has served no merely to illustrate these phenomena can be seen
in laboratory and field ecosystems, but also to spark suggestions of
additional possible indicators and surface a wide array of 
practical [@Boettiger2013b; @Scheffer2015], statistical [e.g. @Boettiger2012d; @Boettiger2012], and theoretical [e.g. @Dai2015; @Wysham2010] challenges to such application.  This
creates a two-way dialog between empirical and theoretical work that does
much to advance the field as a whole.


# Conclusions

The past two decades have seen widespread recognition of the central
role that stochasticity plays through the use of mechanistic models
can have in creating and understanding ecological phenomena
[@Coulson2004; @Black2012]. We have seen increasing use of
master-equation approaches to individual-based models to reflect
demographic stochasticity that is amenable to analytical treatment
[@Black2012], and much work in understanding the importance of
environmental noise, particularly the more realistic but less
mathematically convenient notion of colored or auto-correlated noise
on population dynamics, persistence, and coexistence [@Ovaskainen2010;
@Schreiber2017].  These deductive models can generate phenomena
that resemble familiar patterns such as population cycles for which
we have previously sought deterministic explanations, as well as
stochastic phenomena with no such analog such as stochastic switching.
Yet too many of these advances have remained limited to the domain
of theory; limited to deductive models which may seek to mimic
observed patterns but are rarely used to confront empirical data
directly.  There is good reason for this: statistical inference of
even relatively simple models with multiple sources of noise will
always be difficult given limited ecological data [@Knape2011].
However, many stochastic phenomena may suggest new ways to infer
rather than merely obscure underlying processes.


The eruption of interest in early warning signals for critical
transitions [@Scheffer2009] provides an excellent illustration of
this potential.  A range of stochastic phenomena have been suggested
and a tested for their potential to reveal subtle signs of ecosystem
change prior to a dramatic shift, and prompted a rich dialog between
further theory and new experiment. Changes in stochastic properties
such as variance or auto-correlation provide evidence of resilience
loss that would be invisible to a deterministic model, and non-linear
stochastic phenomena such as stochastic switching are observed as
evidence of 'flickering' prior to a critical transition.  In this
way, our understanding of stochastic dynamics is translated into
novel sources of information about a system which has sparked a
wealth of empirical investigation and further theoretical work to
test the potential of this approach.  The study and application of
stochastic phenomena to detect ecosystem change is unlikely to be
limited to this simple scenario of a critical transition or fold
bifurcation.

Precisely because most stochastic phenomena arise through their
interaction with non-linearity, the patterns that result can become
a lens into better understanding those nonlinear processes and
detecting how they may change.  Meanwhile, the widespread adoption
of computational tools and the ability to express theoretical results
in numerical algorithms can make any new approaches more readily
accessible to application in empirical research. In the past two
decades, we have set to rest those deterministic skeletons that see
noise only as nuisance and embraced the central role noise plays
as the creator of ecological phenomena. Going forward, I hope and
predict that we will see greater discussion and use of stochastic
phenomena to infer underlying processes in empirical patterns in
similar interactions between theoretical and empirical research.



# References
















